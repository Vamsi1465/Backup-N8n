{
  "createdAt": "2025-12-04T19:45:21.782Z",
  "updatedAt": "2025-12-10T18:58:13.000Z",
  "id": "STia7TWDgzrXBnB8",
  "name": "Instagram DM Automation",
  "active": false,
  "isArchived": false,
  "nodes": [
    {
      "parameters": {
        "sessionIdType": "customKey",
        "sessionKey": "={{ $('Extracts ID').first().json.body.entry[0].messaging[0].sender.id }}",
        "contextWindowLength": 20
      },
      "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
      "typeVersion": 1.3,
      "position": [
        720,
        304
      ],
      "id": "9b348b82-f9b3-4be5-8d62-2ca846646014",
      "name": "Simple Memory"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $json.conversation_log }},{{ $('Extracts ID').first().json.Text }}",
        "options": {
          "systemMessage": "=# Lumoscale Chat and Lead Qualification AI Prompt\n\nYou are a Lead Qualification and Chat Assistant for Lumoscale.  \nYou chat like a real human and qualify people in the background.\n\nYour job is to:\n- Sound friendly and natural\n- Hold short, warm conversations\n- Understand their problem and intent\n- Quietly qualify them without sounding salesy\n- Never show analysis\n- Always reply in JSON only\n\n---\n\n## INPUT YOU WILL RECEIVE\n\nYou will receive:\n\nconversation_log â†’ Past messages  \nnew_message â†’ Latest user message  \n\nConversation so far:\n{{ $json.conversation_log }}\n{{ $('Extracts ID').first().json.Text }}\nNew message:\n\n\n---\n\n## HOW TO THINK QUIETLY\n\nWhile chatting, evaluate:\n\n- How clear they are\n- How serious they sound\n- How emotionally invested they are\n- Whether they are ready for action\n- Whether this is a real business need\n\nThen convert that into internal signals:\n\n- Problem Summary  \n- Need Type  \n- Readiness Level  \n- Lead Score  \n- Coach Notes  \n\nNever show these thoughts to the user.\n\n---\n\n## REPLY STYLE RULES\n\nWrite like a real person sending texts:\n\n- Short messages\n- Simple words\n- Natural tone\n- Tiny casual phrases like \"haha\" or \"got you\"\n- A maximum of 2 emojis\n- Never sound corporate or robotic\n- Always end with a soft question\n\n---\n\n## WHAT TO SAY BY SITUATION\n\n### If they greet:\nExample:\n\"Hey nice to connect ðŸ‘‹ how is your day going haha\"\n\n---\n\n### If they ask what Lumoscale does:\nExample:\n\"I help coaches save time by automating the boring stuff like leads and onboarding so they can focus on coaching. What part are you trying to improve right now\"\n\n---\n\n### If they mention a problem:\nExample:\n\"I get you, that stuff gets heavy fast. What part feels the most annoying right now\"\n\n---\n\n### If message is unclear:\nExample:\n\"Haha got you. What are you trying to fix or improve in your workflow right now\"\n\n---\n\n### If they say no budget or not ready:\nExample:\n\"Totally fair, timing matters. Want a small free example you can try later\"\n\n---\n\n### If they show interest in a call:\nExample:\n\"Nice, happy to chat through this with you. If you want, you can grab a quick spot here and we go deeper ðŸ‘‰ https://cal.com/yourlink\"\n\n---\n\n## LEAD QUALIFICATION RULES (INTERNAL)\n\n### Confidence Score\n- High â†’ clear problem + urgency\n- Medium â†’ curious, unsure\n- Low â†’ vague or casual\n\n### Lead Score\n- 1 â†’ random or early browsing\n- 2 â†’ light curiosity\n- 3 â†’ real but slow\n- 4 â†’ strong interest\n- 5 â†’ wants action now\n\n### Readiness Level\n- Unknown â†’ no signal yet\n- Exploring â†’ learning mode\n- Interested â†’ open to help\n- Ready â†’ wants results now\n\n---\n\n## OUTPUT FORMAT (STRICT JSON)\n\nAlways return full JSON. Never leave fields empty.\n\n```json\n{\n  \"reply\": \"\",\n  \"intent\": \"Greeting or Inquiry or Problem or Objection or Call or Other\",\n  \"confidence\": \"High or Medium or Low\",\n  \"next_action\": \"Ask More or Qualify Lead or Wait\",\n  \"lead_summary\": {\n    \"Problem Summary\": \"\",\n    \"Need Type\": \"mindset or business or clarity or strategy or Unknown\",\n    \"Readiness Level\": \"Exploring or Interested or Ready or Unknown\",\n    \"Lead Score\": \"1\",\n    \"Coach Notes\": \"\"\n  }\n}\n```\n\n---\n\n## COMPLETE REAL-WORLD EXAMPLES\n\n### Example 1: Greeting Only\n\nUser: \"Hey\"\n\nOutput:\n```json\n{\n  \"reply\": \"Hey nice to connect ðŸ‘‹ how is your day going haha\",\n  \"intent\": \"Greeting\",\n  \"confidence\": \"Low\",\n  \"next_action\": \"Ask More\",\n  \"lead_summary\": {\n    \"Problem Summary\": \"Not yet identified\",\n    \"Need Type\": \"Unknown\",\n    \"Readiness Level\": \"Unknown\",\n    \"Lead Score\": \"1\",\n    \"Coach Notes\": \"Not enough info\"\n  }\n}\n```\n\n---\n\n### Example 2: Asking About Lumoscale\n\nUser: \"What do you do exactly?\"\n\nOutput:\n```json\n{\n  \"reply\": \"I help coaches automate leads and onboarding so things run smoother. What part are you trying to improve right now\",\n  \"intent\": \"Inquiry\",\n  \"confidence\": \"Medium\",\n  \"next_action\": \"Qualify Lead\",\n  \"lead_summary\": {\n    \"Problem Summary\": \"Looking for automation help\",\n    \"Need Type\": \"strategy\",\n    \"Readiness Level\": \"Exploring\",\n    \"Lead Score\": \"2\",\n    \"Coach Notes\": \"Early stage, ask about pain\"\n  }\n}\n```\n\n---\n\n### Example 3: Expressing Frustration\n\nUser: \"I struggle with getting clients\"\n\nOutput:\n```json\n{\n  \"reply\": \"Yeah that part is rough ðŸ˜… what has been the toughest thing about getting clients so far\",\n  \"intent\": \"Problem\",\n  \"confidence\": \"Medium\",\n  \"next_action\": \"Qualify Lead\",\n  \"lead_summary\": {\n    \"Problem Summary\": \"Struggling to get clients\",\n    \"Need Type\": \"business\",\n    \"Readiness Level\": \"Interested\",\n    \"Lead Score\": \"3\",\n    \"Coach Notes\": \"Probe deeper into lead generation\"\n  }\n}\n```\n\n---\n\n### Example 4: Ready for a Call\n\nUser: \"Can we talk about this?\"\n\nOutput:\n```json\n{\n  \"reply\": \"Yeah for sure, happy to go deeper with you. You can grab a quick slot here whenever works ðŸ‘‰ https://cal.com/yourlink\",\n  \"intent\": \"Call\",\n  \"confidence\": \"High\",\n  \"next_action\": \"Qualify Lead\",\n  \"lead_summary\": {\n    \"Problem Summary\": \"Wants direct guidance\",\n    \"Need Type\": \"strategy\",\n    \"Readiness Level\": \"Ready\",\n    \"Lead Score\": \"5\",\n    \"Coach Notes\": \"Send calendar link and move to call\"\n  }\n}\n```\n\n---\n\n### Example 5: Not Ready / No Budget\n\nUser: \"Not ready to spend right now\"\n\nOutput:\n```json\n{\n  \"reply\": \"No stress at all, timing matters. Want a small example you can try first\",\n  \"intent\": \"Objection\",\n  \"confidence\": \"Low\",\n  \"next_action\": \"Wait\",\n  \"lead_summary\": {\n    \"Problem Summary\": \"Budget hesitation\",\n    \"Need Type\": \"mindset\",\n    \"Readiness Level\": \"Exploring\",\n    \"Lead Score\": \"2\",\n    \"Coach Notes\": \"Nurture with free value\"\n  }\n}\n```\n\n---\n\n## FINAL RULES\n\n- Always reply in JSON only  \n- Always include all fields  \n- Never sound like a bot  \n- Always ask one soft question  \n- Never expose logic  \n- Never return null values  \n- Keep replies short  \n- Friendly tone always  \n\n"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2.2,
      "position": [
        704,
        112
      ],
      "id": "cadfcf5d-2ddf-4add-bf3c-d974b8b44ee2",
      "name": "AI Agent"
    },
    {
      "parameters": {
        "multipleMethods": true,
        "httpMethod": [
          "POST",
          "GET"
        ],
        "path": "Instagram-dm",
        "responseMode": "responseNode",
        "options": {}
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2.1,
      "position": [
        -416,
        208
      ],
      "id": "d26f6ad6-1089-40b0-8efe-c5785b0fc4c0",
      "name": "Instagram DMs",
      "webhookId": "8f3ef1ea-5ba5-454b-a611-f0a53df234fd"
    },
    {
      "parameters": {
        "respondWith": "text",
        "responseBody": "={{ $json.query['hub.challenge'] }}",
        "options": {}
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.4,
      "position": [
        -224,
        352
      ],
      "id": "ead34f85-4c5b-47ed-a986-c07e2b0d9c6e",
      "name": "Respond to Webhook"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://graph.instagram.com/v24.0/me/messages",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "Bearer IGAANy9Ku2eeZABZAFNlQlBJQ1J2aTFLRmRaTjdTdTZANdS1KdW9MTkhnZAHhVeUFYX0k4U1gxQlpabU4zQURuR2RpcG1HNDByUHl3N2FMZA0FJUjlCeEMxUzZAKb1NGeTlNREdZASHQ4a2RJLW5fcHMydlFkS1h2TEF0Q3Rja01aUGluSQZDZD"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"recipient\": {\n    \"id\": \"{{ $('Extracts ID').first().json.body.entry[0].messaging[0].sender.id }}\"\n  },\n  \"message\": {\n    \"text\": \"{{ $('Format Prompt').first().json.reply }}\"\n  },\n  \"messaging_type\": \"RESPONSE\"\n}\n",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        2704,
        112
      ],
      "id": "662dfd1f-2e9d-425b-acd8-925e5c0af292",
      "name": "Send reply back in Instagram"
    },
    {
      "parameters": {
        "content": "# Instagram DM ChatBot",
        "height": 896,
        "width": 3568,
        "color": 3
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -576,
        -240
      ],
      "typeVersion": 1,
      "id": "50f42f1f-82f6-4362-a375-8a5908014ab9",
      "name": "Sticky Note1"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "6bd88b13-825f-4c9e-bce8-a45d423433db",
              "name": "body.entry[0].messaging[0].sender.id",
              "value": "={{ $json.body.entry[0].messaging[0].sender.id }}",
              "type": "string"
            },
            {
              "id": "c95fbccd-0bc0-438b-8d67-4d9c9de62d41",
              "name": "Text",
              "value": "={{ \n  $json.body.entry[0].messaging[0].message \n    ? $json.body.entry[0].messaging[0].message.text \n    : ($json.body.entry[0].messaging[0].message_edit \n        ? $json.body.entry[0].messaging[0].message_edit.text \n        : \"\") \n}}",
              "type": "string"
            },
            {
              "id": "397a18db-5a5b-419a-a8c1-d606d623e1cc",
              "name": "direction",
              "value": "Incoming",
              "type": "string"
            },
            {
              "id": "dd49e08a-ae00-4f37-b2d2-c1459c904725",
              "name": "timestamp",
              "value": "={{ $now.toLocaleString(\"en-IN\", { timeZone: \"Asia/Kolkata\" }) }}",
              "type": "string"
            },
            {
              "id": "bbf49ade-52ec-4d54-91e2-3fb27d3930b0",
              "name": "echo",
              "value": "={{ $json.body.entry[0].messaging[0].message.is_echo }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -176,
        96
      ],
      "id": "ac60faba-f003-47d1-b9f8-ad5bca888896",
      "name": "Extracts ID"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "72766303-8b9a-4178-bf5f-c0d0d8c1b313",
              "leftValue": "={{ $json.echo }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "exists",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        32,
        96
      ],
      "id": "ec28ce79-4b68-413f-a7aa-4b6b50c63d10",
      "name": "If"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "typeVersion": 1,
      "position": [
        2208,
        1104
      ],
      "id": "5f7775a0-3d0f-42c5-bc4d-2cd05dfa9c8d",
      "name": "Google Gemini Chat Model4",
      "credentials": {
        "googlePalmApi": {
          "id": "Gq3qNdXZmlzVb7Jg",
          "name": "Google Gemini(PaLM) Api account"
        }
      }
    },
    {
      "parameters": {
        "rule": {
          "interval": [
            {}
          ]
        }
      },
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.2,
      "position": [
        -496,
        1072
      ],
      "id": "040b873c-b086-43ec-bae2-8aef8ac269b7",
      "name": "Checks every 30min"
    },
    {
      "parameters": {
        "operation": "getAll",
        "calendar": {
          "__rl": true,
          "value": "vamsivk1465@gmail.com",
          "mode": "list",
          "cachedResultName": "vamsivk1465@gmail.com"
        },
        "returnAll": true,
        "timeMin": "={{ $now.toFormat(\"yyyy-MM-dd\") }}",
        "timeMax": "={{ $now.plus({ days: 3 }).toFormat(\"yyyy-MM-dd\") }}",
        "options": {}
      },
      "type": "n8n-nodes-base.googleCalendar",
      "typeVersion": 1.3,
      "position": [
        -288,
        1072
      ],
      "id": "ec94ad04-f001-48b7-940d-d9b64c315105",
      "name": "Get All Meetings",
      "credentials": {
        "googleCalendarOAuth2Api": {
          "id": "g4VAMKMrPf3B63WZ",
          "name": "Google Calendar account"
        }
      }
    },
    {
      "parameters": {
        "fieldToSplitOut": "id,summary, start.dateTime, end.dateTime, attendees[0].email, attendees[1].email, description",
        "options": {}
      },
      "type": "n8n-nodes-base.splitOut",
      "typeVersion": 1,
      "position": [
        -96,
        1072
      ],
      "id": "851f55a1-280a-4a54-a298-1fcf76fe2b6f",
      "name": "Split out all Meetings"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "fb70f2da-d1f5-494e-9d94-b96ef7706aae",
              "name": "start.dateTime",
              "value": "={{ $json['start.dateTime'] }}",
              "type": "string"
            },
            {
              "id": "d6f678c9-3aef-4885-9387-c0997adc2e76",
              "name": "$now",
              "value": "={{ $now }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        112,
        1072
      ],
      "id": "57610311-4f42-48cc-8077-c4c0eb7919b4",
      "name": "Edit start and end time"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        384,
        1072
      ],
      "id": "f154cd8c-9faf-4dc3-b0d3-96003a23ed65",
      "name": "Loop "
    },
    {
      "parameters": {
        "jsCode": "const outputItems = [];\n\nfor (const item of items) {\n    if (!item.json.start || !item.json.start.dateTime) continue;\n\n    // Convert startTime from ISO string\n    const startTime = new Date(item.json.start.dateTime);\n\n    // Convert current time from $now if available, otherwise use system time\n    const now = item.json.$now ? new Date(item.json.$now) : new Date();\n\n    // Calculate difference in hours\n    const diffHours = Math.round((startTime - now) / (1000 * 60 * 60));\n\n    outputItems.push({\n        json: {\n            eventId: item.json.id || null,\n            summary: item.json.summary || null,\n            hoursUntilStart: diffHours <= 0 ? \"0hr\" : (diffHours === 1 ? \"1hr\" : `${diffHours}hrs`)\n        }\n    });\n}\n\nreturn outputItems;\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        704,
        1088
      ],
      "id": "aa626cbb-cfc7-4245-a34d-0db4621c21c8",
      "name": "Checks the time diff ",
      "alwaysOutputData": true
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "d10833b8-63d8-4353-93e4-37a8c32c4e67",
              "name": "time",
              "value": "={{ $json.hoursUntilStart }}",
              "type": "string"
            },
            {
              "id": "2f669074-3ed7-4c3e-9c42-e7c02545db7f",
              "name": "summary",
              "value": "={{ $('Split out all Meetings').item.json.summary }}",
              "type": "string"
            },
            {
              "id": "e6a3ea7a-85b6-4e92-9168-6087f3587eea",
              "name": "['attendees[1].email']",
              "value": "={{ $('Get All Meetings').item.json.attendees[0].email }}",
              "type": "string"
            },
            {
              "id": "a1f961b0-69ea-4507-8fec-dd831ee9dad3",
              "name": "start.dateTime",
              "value": "={{ new Date($('Split out all Meetings').item.json['start.dateTime']).toLocaleString('en-IN', { timeZone: 'Asia/Kolkata' }) }}",
              "type": "string"
            },
            {
              "id": "f8c6c483-49df-4d8a-8d7d-90da2a6ba5cd",
              "name": "creator.email",
              "value": "={{ $('Get All Meetings').item.json.creator.email }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        928,
        1088
      ],
      "id": "2e767b49-66df-47dc-83bf-aec2ddd46b2e",
      "name": "Edit required fields in calender"
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.time }}",
                    "rightValue": "2hr",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "6099b2d2-dab8-4f46-9def-2d5212842ca3"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "2hr"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "1862f489-fcc6-4dbc-aaa4-ac70af544a75",
                    "leftValue": "={{ $json.time }}",
                    "rightValue": "6hr",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "6hr"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "3cf1231d-d375-441c-95e5-ce09230cdc99",
                    "leftValue": "={{ $json.time }}",
                    "rightValue": "1hr",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "1hr"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "e22774b6-296f-4200-b071-20265266bf0a",
                    "leftValue": "={{ $json.isValid.toString() }}",
                    "rightValue": "false",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        1568,
        1056
      ],
      "id": "55a5bfe6-400b-4732-89ee-6fc9165581a4",
      "name": "Switch btw hrs",
      "alwaysOutputData": false
    },
    {
      "parameters": {
        "modelId": {
          "__rl": true,
          "value": "models/gemini-2.5-flash-lite-preview-06-17",
          "mode": "list",
          "cachedResultName": "models/gemini-2.5-flash-lite-preview-06-17"
        },
        "messages": {
          "values": [
            {
              "content": "={{ $('Edit required fields in calender').item.json.time }}, {{ $('Edit required fields in calender').item.json.summary }},{{ $('Edit required fields in calender').item.json['attendees[1].email'] }},{{ $('Edit required fields in calender').item.json.start.dateTime }}, {{ $('Edit required fields in calender').item.json.creator.email }}"
            }
          ]
        },
        "simplify": false,
        "jsonOutput": true,
        "options": {
          "systemMessage": "=You are an AI assistant for professional scheduling and reminders.  \nYour task is to write concise, friendly, and exciting emails for booked meetings.  \n\nInputs:  \n- Attendee email: {{ $('Edit required fields in calender').item.json['attendees[1].email'] }}\n- Attendee name: (infer from email if possible, e.g., \"john.doe@gmail.com\" â†’ \"John\")  \n- Meeting summary: {{ $('Edit required fields in calender').item.json.summary }}\n- Meeting date and time: {{ $('Edit required fields in calender').item.json.start.dateTime }}\n- Time until meeting:{{ $('Edit required fields in calender').item.json.time }}(e.g., \"2hrs\", \"3hrs\")  \n- Type of email: (confirmation or reminder)  \n- Organizer email: {{ $('Edit required fields in calender').item.json.creator.email }} (use this to refer to the organizerâ€™s name professionally)\n\nRequirements:  \n1. If `emailType` is \"confirmation\", write a professional email acknowledging the booking. Include a friendly greeting, thank the attendee, mention the meeting date/time, and add an exciting note about looking forward to the discussion using the `hoursUntilStart` input.  \n2. If `emailType` is \"reminder\", write a friendly reminder 2 hours before the meeting. Include the meeting summary, date/time, and an enthusiastic note about speaking soon using `hoursUntilStart`.  \n3. Emails should be:  \n   - 3â€“5 sentences  \n   - Polite, professional, and exciting  \n   - Include a greeting using the attendeeâ€™s name  \n   - Include a professional sign-off using the organizerâ€™s name  \n   - Use phrases like â€œIâ€™m really looking forward to our conversation,â€ â€œcanâ€™t wait to discuss,â€ or â€œexcited to connect.â€  \n4. Output only the ready-to-send email text. No explanations.\n\nExample output (confirmation):  \n\"Dear John,  \nThank you for scheduling a meeting regarding 'Project Discussion'. Your meeting is confirmed for October 16th at 12:00 PM IST. Iâ€™m really looking forward to our conversation and canâ€™t wait to dive into the discussion with you in just 2hrs!  \nBest regards,  \nJane Doe\"\n\nExample output (reminder):  \n\"Dear John,  \nThis is a friendly reminder of your upcoming meeting 'Project Discussion' scheduled for October 16th at 12:00 PM IST. Iâ€™m excited to connect with you in 2hrs and discuss everything in detail. Please let me know if you need to adjust the timing.  \nBest regards,  \nJane Doe\"\n"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.googleGemini",
      "typeVersion": 1,
      "position": [
        1888,
        944
      ],
      "id": "4ea433f4-1487-4a99-aaa1-33cb5327d08c",
      "name": "Send personalized message ( Email )",
      "credentials": {
        "googlePalmApi": {
          "id": "Gq3qNdXZmlzVb7Jg",
          "name": "Google Gemini(PaLM) Api account"
        }
      }
    },
    {
      "parameters": {
        "text": "={{ $json.candidates[0].content.parts[0].text }}",
        "attributes": {
          "attributes": [
            {
              "name": "Subject",
              "description": "Take subject out with clear idea",
              "required": true
            },
            {
              "name": "Body",
              "description": "Take out body with clear words",
              "required": true
            }
          ]
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.informationExtractor",
      "typeVersion": 1.2,
      "position": [
        2272,
        944
      ],
      "id": "2a7a491d-f52e-48c6-9ac7-c958b7ab05ed",
      "name": "Extract Information out"
    },
    {
      "parameters": {
        "sendTo": "=vamsikrishna2536@gmail.com",
        "subject": "={{ $json.output.Subject }}",
        "emailType": "text",
        "message": "={{ $json.output.Body }}",
        "options": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        2608,
        944
      ],
      "id": "78330991-7ec2-4c65-9a30-94c362e88c6d",
      "name": "Send a Booking email alert",
      "webhookId": "8bc0d4d6-8c1c-4bea-9f46-d46cb034971a",
      "credentials": {
        "gmailOAuth2": {
          "id": "UbWO1LFfZ6s8MzMA",
          "name": "Gmail account"
        }
      }
    },
    {
      "parameters": {
        "modelId": {
          "__rl": true,
          "value": "models/gemini-2.5-flash-lite-preview-06-17",
          "mode": "list",
          "cachedResultName": "models/gemini-2.5-flash-lite-preview-06-17"
        },
        "messages": {
          "values": [
            {
              "content": "=You are an assistant for sending professional and friendly reminders or confirmations via WhatsApp or Telegram.  \nYour task is to write concise, engaging, and exciting messages for booked meetings.  \n\nInputs:  \n- Attendee email: {{ $('Edit required fields in calender').item.json['attendees[1].email'] }}\n- Attendee name: (infer from email if possible, e.g., \"john.doe@gmail.com\" â†’ \"John\")  \n- Meeting summary: {{ $('Edit required fields in calender').item.json.summary }}\n- Meeting date and time: {{ $('Edit required fields in calender').item.json.start.dateTime }}\n- Time until meeting: {{ $('Edit required fields in calender').item.json.time }} (e.g., \"2hrs\", \"3hrs\")  \n- Type of message: (confirmation or reminder)  \n- Organizer email: {{ $('Edit required fields in calender').item.json.creator.email }} (use this to refer to the organizerâ€™s name professionally)\n\nRequirements:  \n1. If `messageType` is \"confirmation\", write a short WhatsApp/Telegram message acknowledging the booking. Include:  \n   - Friendly greeting using the attendeeâ€™s name  \n   - Meeting summary and date/time  \n   - Exciting note using `time` (e.g., \"Looking forward to connecting with you in 2hrs!\")  \n   - Optional quick call-to-action if needed  \n2. If `messageType` is \"reminder\", write a concise reminder message 2 hours before the meeting. Include:  \n   - Meeting summary and date/time  \n   - Exciting, friendly note mentioning `time`  \n   - Optional note to reply if they need to reschedule  \n3. Messages should be:  \n   - Short and natural (1â€“3 sentences)  \n   - Friendly, professional, and enthusiastic  \n   - Easy to read on mobile chat  \n4. Output only the ready-to-send message text, no extra explanations.\n\nExample output (confirmation):  \n\"Hi John, thanks for scheduling a meeting about 'Project Discussion'. It's set for Oct 16th at 12:00 PM IST. Really excited to connect with you in just 2hrs!\"  \n\nExample output (reminder):  \n\"Hi John, a quick reminder about your 'Project Discussion' meeting at Oct 16th, 12:00 PM IST. Can't wait to talk with you in 2hrs!\"\n"
            }
          ]
        },
        "simplify": false,
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.googleGemini",
      "typeVersion": 1,
      "position": [
        1984,
        1248
      ],
      "id": "31e77f73-9429-4cf6-a8f9-0d5bc8c5dba8",
      "name": "Send personalized DM",
      "credentials": {
        "googlePalmApi": {
          "id": "Gq3qNdXZmlzVb7Jg",
          "name": "Google Gemini(PaLM) Api account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "23",
        "text": "HI",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2512,
        1200
      ],
      "id": "944c0777-9c5d-4104-9acd-eb5dc3ebf085",
      "name": "Send a remainder in Telegram",
      "webhookId": "0b182a8a-c988-4111-a16f-68a83bde7f1f",
      "credentials": {
        "telegramApi": {
          "id": "gwHBxrkrPXY0I5Fk",
          "name": "Normal"
        }
      }
    },
    {
      "parameters": {
        "operation": "send",
        "phoneNumberId": "802657959596026",
        "recipientPhoneNumber": "+918919053970",
        "textBody": "Hello",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.whatsApp",
      "typeVersion": 1,
      "position": [
        2496,
        1408
      ],
      "id": "ce58512c-f1c8-4ba0-b260-500c78c84215",
      "name": "Send a remainder in Whatsapp",
      "webhookId": "ee19619e-9f28-459b-a7dc-5ab34fa53e53",
      "credentials": {
        "whatsAppApi": {
          "id": "ixk5U1dBT3xISilr",
          "name": "WhatsApp account"
        }
      }
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "6924e89c-a091-4dce-adee-db0a6fdd4bcc",
              "name": "['attendees[1].email']",
              "value": "={{ $('Edit required fields in calender').item.json['attendees[1].email'] }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -192,
        1600
      ],
      "id": "cc427f39-802c-4a15-91cf-ffa6e54bf92e",
      "name": "Edit only Req Fields"
    },
    {
      "parameters": {
        "jsCode": "// Get time value from previous node\nconst time = $json.time?.toLowerCase()?.trim() || \"\";\n\n// Allowed time values\nconst validTimes = [\"1hr\", \"2hrs\", \"6hrs\"];\n\n// Check if matches\nconst isValid = validTimes.includes(time);\n\n// Return result\nreturn [{ time, isValid }];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1136,
        1088
      ],
      "id": "e7df0caf-d0d5-427b-abcf-afee6ac986f0",
      "name": "Check true or false "
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1IUNIvKOc2s6qmjwrMZLpuhgvvK_py2sXskapsOswS04",
          "mode": "list",
          "cachedResultName": "Lead Qualification System",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1IUNIvKOc2s6qmjwrMZLpuhgvvK_py2sXskapsOswS04/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1573018970,
          "mode": "list",
          "cachedResultName": "Gmail",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1IUNIvKOc2s6qmjwrMZLpuhgvvK_py2sXskapsOswS04/edit#gid=1573018970"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "Email",
              "lookupValue": "={{ $json['attendees[1].email'] }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        80,
        1600
      ],
      "id": "2a357286-4b4a-47ae-9949-b91d8daff3d1",
      "name": "Get row(s) in sheet4",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "3MsYFPOz6gYs3lBk",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "oAuth2",
        "select": "channel",
        "channelId": {
          "__rl": true,
          "value": "C09PV3DSRJQ",
          "mode": "list",
          "cachedResultName": "n8n"
        },
        "text": "=Pre call brief:\n{{ $json.Name }}\n{{ $json.Email }}\n{{ $json.Lead_Stage }}\n{{ $json.Need_Type }}\n\n",
        "otherOptions": {}
      },
      "type": "n8n-nodes-base.slack",
      "typeVersion": 2.3,
      "position": [
        1248,
        1600
      ],
      "id": "65ca5d77-b8a2-4c05-9f32-dc815269212c",
      "name": "Send a message4",
      "webhookId": "24db3fa1-87d7-415d-81d0-5cab88ec98d6",
      "credentials": {
        "slackOAuth2Api": {
          "id": "Rb7HyhAgq0iIU3TT",
          "name": "Slack account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// Split the Lead Snapshot into structured fields\n\nfor (const item of $input.all()) {\n  const snapshot = item.json.Lead_Snapshot || \"\";\n\n  // Extract key fields using regex\n  const name = snapshot.match(/Name:\\s*(.*?)(?=\\s*- Email|$)/i)?.[1]?.trim() || \"\";\n  const email = snapshot.match(/Email:\\s*(.*?)(?=\\s*- Date|$)/i)?.[1]?.trim() || \"\";\n  const date = snapshot.match(/Date:\\s*(.*?)(?=\\s*- Lead Stage|$)/i)?.[1]?.trim() || \"\";\n  const leadStage = snapshot.match(/Lead Stage:\\s*(.*?)(?=\\s*- Lead Score|$)/i)?.[1]?.trim() || \"\";\n  const leadScore = snapshot.match(/Lead Score:\\s*(.*?)(?=\\s*- Need Type|$)/i)?.[1]?.trim() || \"\";\n  const needType = snapshot.match(/Need Type:\\s*(.*)/i)?.[1]?.trim() || \"\";\n\n  // Add structured fields to JSON\n  item.json = {\n    ...item.json,\n    Name: name,\n    Email: email,\n    Date: date,\n    Lead_Stage: leadStage,\n    Lead_Score: leadScore,\n    Need_Type: needType\n  };\n}\n\nreturn $input.all();\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1024,
        1600
      ],
      "id": "a2971a83-f02e-40a0-99e0-448572f836b5",
      "name": "Divide Lead Details"
    },
    {
      "parameters": {
        "content": "# Meeting Remainder for \n## 1. 24hrs\n## 2. 6hrs\n## 3. 1hr precall + remainder",
        "height": 1440,
        "width": 3728
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -736,
        688
      ],
      "typeVersion": 1,
      "id": "d17866ad-9cf7-47b5-8b77-adab63a6b94d",
      "name": "Sticky Note"
    },
    {
      "parameters": {
        "modelId": {
          "__rl": true,
          "value": "gpt-4.1-mini-2025-04-14",
          "mode": "list",
          "cachedResultName": "GPT-4.1-MINI-2025-04-14"
        },
        "messages": {
          "values": [
            {
              "content": "=You are an AI assistant that prepares a detailed Pre-Call Brief for a coach.\n\nYou will receive structured data from an automation system that includes all relevant fields about a lead, such as:\n\n- Date: {{ $json.Date }}\n- Name: {{ $json.Name }}\n- Email: {{ $json.Email }}\n- Text: {{ $json.Text }}\n- problem_summary: {{ $json.problem_summary }}\n- need_type: {{ $json.need_type }}\n- lead_score: {{ $json.lead_score }}\n- Lead Stage: {{ $json[\"Lead Stage\"] }}\n- reason: {{ $json.reason }}\n- coach_notes: {{ $json.coach_notes }}\n(and possibly other fields in the same format)\n\n---\n\n### ðŸ§­ Instructions\n\n1. Use **all fields available** â€” do not ignore any.\n2. Identify the type of lead:\n   - If itâ€™s system-generated, spam, or irrelevant â†’ mention clearly.\n   - If itâ€™s a real human lead â†’ summarize their goals, needs, and challenges.\n3. Extract insights:\n   - â€œTextâ€ â†’ what the person said.\n   - â€œproblem_summaryâ€ â†’ what issue or goal they have.\n   - â€œneed_typeâ€ â†’ what category this falls into.\n   - â€œlead_scoreâ€ & â€œLead Stageâ€ â†’ how ready or qualified they are.\n   - â€œreasonâ€ & â€œcoach_notesâ€ â†’ why it was classified that way and what to do next.\n\n---\n\n### ðŸ§¾ Output Format\n\n**1. Lead Snapshot**\n- Name:\n- Email:\n- Date:\n- Lead Stage:\n- Lead Score:\n- Need Type:\n\n**2. Conversation Summary**\nSummarize the â€œTextâ€ field in one or two lines and explain what it tells us about the leadâ€™s intent.\n\n**3. Problem / Goal**\nExplain what problem or goal they have using â€œproblem_summaryâ€.\n\n**4. Context & Insights**\nSummarize the â€œreasonâ€ and â€œcoach_notesâ€ fields to help the coach understand how to approach this lead.\n\n**5. Preparation for Coach**\n- What the coach should know before the call.\n- Recommended tone or communication style.\n- What to prepare (stories, tools, examples).\n\n**6. Smart Questions to Ask**\nWrite 4â€“6 personalized questions that help the coach explore the leadâ€™s goals, pain points, and readiness (skip if irrelevant).\n\n**7. Recommended Next Step**\nClearly state what action to take:\n- Book a call / proceed\n- Follow up\n- Ignore / mark as system message\n- Gather more information\n\n---\n\n### Output\nProvide a detailed, structured **Pre-Call Brief** in clear, human-readable language following the above format."
            }
          ]
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 1.8,
      "position": [
        384,
        1600
      ],
      "id": "e81fb828-bb7e-4f00-b891-0b0179ada119",
      "name": "Message a model1",
      "credentials": {
        "openAiApi": {
          "id": "8cTwctTGeEBOJeUq",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// n8n Code Node: Split Pre-Call Brief Markdown into JSON sections (with Summary fix)\n\nfor (const item of $input.all()) {\n  const content = item.json.message?.content || item.json.content || \"\";\n\n  // Helper function to extract section content safely\n  function extractSection(title) {\n    const regex = new RegExp(`\\\\*\\\\*${title}\\\\*\\\\*[\\\\s\\\\S]*?(?=\\\\n\\\\n---|$)`, \"i\");\n    const match = content.match(regex);\n    if (!match) return \"not available\";\n\n    return match[0]\n      .replace(new RegExp(`\\\\*\\\\*${title}\\\\*\\\\*`, \"i\"), \"\")\n      .replace(/^-+|\\*+|\\n+/g, \"\")\n      .trim();\n  }\n\n  // Extract each section\n  const Lead_Snapshot = extractSection(\"1\\\\. Lead Snapshot\");\n  const Conversation_Summary = extractSection(\"2\\\\. Conversation Summary\");\n  const Problem_Goal = extractSection(\"3\\\\. Problem / Goal\");\n  const Context_Insights = extractSection(\"4\\\\. Context & Insights\");\n  const Preparation_for_Coach = extractSection(\"5\\\\. Preparation for Coach\");\n  const Smart_Questions = extractSection(\"6\\\\. Smart Questions to Ask\");\n  const Recommended_Next_Step = extractSection(\"7\\\\. Recommended Next Step\");\n\n  // FIX: Capture the Summary section at the end (even if not separated by ---)\n  let Summary = \"not available\";\n  const summaryMatch = content.match(/\\*\\*Summary:\\*\\*[\\s\\S]*$/i);\n  if (summaryMatch) {\n    Summary = summaryMatch[0]\n      .replace(/\\*\\*Summary:\\*\\*/i, \"\")\n      .trim();\n  }\n\n  // Structured JSON output\n  item.json = {\n    Lead_Snapshot,\n    Conversation_Summary,\n    Problem_Goal,\n    Context_Insights,\n    Preparation_for_Coach,\n    Smart_Questions,\n    Recommended_Next_Step,\n    Summary\n  };\n}\n\nreturn $input.all();\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        768,
        1600
      ],
      "id": "964e4eb8-eb7d-4c1c-bc15-e29dc7fa6e24",
      "name": "Code in JavaScript"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "mode": "list",
          "value": "gpt-4.1-mini"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        576,
        320
      ],
      "id": "9b3f17ad-e51a-4a3d-9701-8339c388a2c7",
      "name": "OpenAI Chat Model",
      "credentials": {
        "openAiApi": {
          "id": "8cTwctTGeEBOJeUq",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "mode": "list",
          "value": "gpt-4.1-mini"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        1600,
        320
      ],
      "id": "21510a4a-3459-470e-a8c3-0bb9f73953e4",
      "name": "OpenAI Chat Model1",
      "credentials": {
        "openAiApi": {
          "id": "8cTwctTGeEBOJeUq",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// Fallback if no sheet data\nconst fallback = $node[\"Extracts ID\"].json;\n\n// Log to debug the exact structure once\nconsole.log('Extracts ID payload:', JSON.stringify(fallback, null, 2));\n\nconst entry = fallback?.body?.entry?.[0];\nconst messaging = entry?.messaging?.[0] || entry?.messaging?.[0];\n\n// Safeguard if no messaging exists\nif (!messaging) {\n  return [{\n    json: {\n      source: \"instagram_dm\",\n      sender_id: null,\n      conversation_log: \"No messaging data found in webhook payload.\",\n      last_5_messages: []\n    }\n  }];\n}\n\nconst senderId = messaging.sender?.id || messaging.from?.id || null;\n\n// Try different locations where user text can live\nconst userText =\n  messaging.message?.text\n  || messaging.message?.caption\n  || messaging.postback?.title\n  || messaging.postback?.payload\n  || \"[No text content in this event]\";\n\nreturn [{\n  json: {\n    source: \"instagram_dm\",\n    sender_id: senderId,\n    conversation_log: `User message 1: ${userText}`,\n    last_5_messages: [{ conversation_history: userText }]\n  }\n}];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        480,
        112
      ],
      "id": "2e3d674e-7ab9-4c49-9d9d-fce8a45e4ab0",
      "name": "Get last 5 Conversations"
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1IUNIvKOc2s6qmjwrMZLpuhgvvK_py2sXskapsOswS04",
          "mode": "list",
          "cachedResultName": "Coaches",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1IUNIvKOc2s6qmjwrMZLpuhgvvK_py2sXskapsOswS04/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1589942840,
          "mode": "list",
          "cachedResultName": "Convo history(insta)",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1IUNIvKOc2s6qmjwrMZLpuhgvvK_py2sXskapsOswS04/edit#gid=1589942840"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "Sender_id",
              "lookupValue": "={{ $json.body.entry[0].messaging[0].sender.id }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        272,
        112
      ],
      "id": "df30b12a-f76f-4435-97d7-d42896a8fbbd",
      "name": "Get previous convo",
      "alwaysOutputData": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "3MsYFPOz6gYs3lBk",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "for (const item of $input.all()) {\n  let raw = item.json.output || \"\";\n\n  // Clean and sanitize raw AI response\n  raw = raw.replace(/```json|```/g, \"\").replace(/\\n/g, \" \").trim();\n\n  // Try parsing JSON safely\n  let data = {};\n  try {\n    data = JSON.parse(raw);\n  } catch (e) {\n    item.json.error = \"Invalid JSON format\";\n    continue;\n  }\n\n  // Helper function to clean text\n  const clean = (str) => (str || \"\").toString().replace(/\\n/g, \" \").trim();\n\n  // Extract main response\n  item.json.reply = clean(data.reply);\n  item.json.intent = clean(data.intent);\n  item.json.confidence = clean(data.confidence);\n  item.json.next_action = clean(data.next_action);\n\n  // Extract nested lead summary (if available)\n  const lead = data.lead_summary || {};\n  item.json.problem_summary = clean(lead[\"Problem Summary\"]);\n  item.json.need_type = clean(lead[\"Need Type\"]);\n  item.json.readiness_level = clean(lead[\"Readiness Level\"]);\n  item.json.lead_score = clean(lead[\"Lead Score\"]);\n  item.json.coach_notes = clean(lead[\"Coach Notes\"]);\n\n  // Add clean formatted summary for debugging/logs\n  item.json.summary_text = `\n    Reply: ${item.json.reply}\n    Intent: ${item.json.intent}\n    Lead Score: ${item.json.lead_score}\n    Problem: ${item.json.problem_summary}\n  `.trim();\n}\n\nreturn $input.all();\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1024,
        112
      ],
      "id": "7c410217-b946-4c34-aa76-f440a3f1c926",
      "name": "Format Prompt",
      "alwaysOutputData": true
    },
    {
      "parameters": {
        "modelId": {
          "__rl": true,
          "value": "gpt-4.1-mini-2025-04-14",
          "mode": "list",
          "cachedResultName": "GPT-4.1-MINI-2025-04-14"
        },
        "messages": {
          "values": [
            {
              "content": "=# Lead Classification AI Prompt (Final High Accuracy Version)\n\n## ROLE\nYou are a Lead Qualification AI for a coaching or high ticket service business.\n\nYour goal is simple:  \nDecide if the lead is **Hot, Warm, Cold, or Unqualified**.\n\nYou think like a coach and like a closer.\nYou judge buying intent, urgency, seriousness, and readiness.\n\n---\n\n## INPUT YOU WILL RECEIVE\n\nconversation_log  \n{{ $('Get last 5 Conversations').item.json.conversation_log }}\n\nnew_message  \n{{ $('Instagram DMs').first().json.body.entry[0].messaging[0].message.text }}\n\nprevious_ai_reply  \n{{ $('Format Prompt').item.json.reply }}\n\nprevious_ai_intent  \n{{ $('Format Prompt').item.json.intent }}\n\nprevious_ai_next_action  \n{{ $('Format Prompt').item.json.next_action }}\n\nproblem_summary  \n{{ $('Format Prompt').item.json.problem_summary }}\n\nneed_type  \n{{ $('Format Prompt').item.json.need_type }}\n\nreadiness_level  \n{{ $('Format Prompt').item.json.readiness_level }}\n\nlead_score  \n{{ $('Format Prompt').item.json.lead_score }}\n\ncoach_notes  \n{{ $('Format Prompt').item.json.coach_notes }}\n\nsummary_text  \n{{ $('Format Prompt').item.json.summary_text }}\n\n---\n\n## YOUR TASK\n\nRead everything.\nLook at message pattern over time.\nIgnore surface words.\nDecide the single most accurate lead stage.\n\n---\n\n## HOW TO THINK\n\nEvaluate in this order:\n\n1) Buying intent  \nAre they asking for results, investment, or next steps?\n\n2) Urgency  \nDo they talk about time, pressure, stress, or need?\n\n3) Ownership  \nDo they take responsibility or blame others?\n\n4) Pattern shift  \nHas the conversation moved closer to action?\n\n5) Emotional weight  \nDo they sound serious or casual?\n\n---\n\n## CLASSIFICATION RULES\n\n### HOT LEAD\nChoose Hot when most of these are true:\n\nStrong buying signals  \nUrgent or emotionally heavy language  \nAsking about pricing, calls, or starting  \nClear desire for change  \nOwnership language\n\nExamples:\n\"I want to start now\"\n\"Are you taking clients?\"\n\"Can we talk about this\"\n\"I need help right now\"\n\"How much is it\"\n\n---\n\n### WARM LEAD\nChoose Warm when:\n\nThey are interested but not urgent  \nThey ask questions  \nThey share problems casually  \nThey are not committing yet\n\nExamples:\n\"I have been thinking about this\"\n\"I want to learn more\"\n\"I might need help\"\n\"Not sure yet but curious\"\n\n---\n\n### COLD LEAD\nChoose Cold when:\n\nShort replies  \nNo clear intent  \nJust greeting or browsing  \nNo emotional pressure\n\nExamples:\n\"Hi\"\n\"Hello\"\n\"Okay\"\n\"Nice\"\n\n---\n\n### UNQUALIFIED\nChoose Unqualified when:\n\nSpam  \nRandom messages  \nIrrelevant content  \nSystem messages\n\nExamples:\n\"Follow for follow\"\n\"Buy crypto\"\n\"Click link\"\n\"Free giveaway\"\n\n---\n\n## OUTPUT FORMAT (STRICT JSON ONLY)\n\nReturn JSON only.  \n\n```json\n{\n  \"lead_stage\": \"Hot or Warm or Cold or Unqualified\",\n  \"reason\": \"One or two short lines explaining why\",\n  \"confidence\": \"High or Medium or Low\"\n}\n```\n\n---\n\n## RULES\n\n- Always pick one stage  \n- Never output outside JSON  \n- Be strict and objective  \n- No politeness  \n- No explanation paragraphs  \n"
            }
          ]
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 1.8,
      "position": [
        1232,
        112
      ],
      "id": "dab0627b-d6b2-4b39-b498-df50896c98a7",
      "name": "Detect lead",
      "credentials": {
        "openAiApi": {
          "id": "8cTwctTGeEBOJeUq",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "text": "={{ $('Extracts ID').first().json.Text }}",
        "attributes": {
          "attributes": [
            {
              "name": "Name",
              "description": "If you find any name then extract or else just return nothing",
              "required": true
            },
            {
              "name": "Email",
              "description": "Whenever if you think you found email then return it or nothing",
              "required": true
            }
          ]
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.informationExtractor",
      "typeVersion": 1.2,
      "position": [
        1600,
        112
      ],
      "id": "89a71806-2066-429a-816f-d4d8eb5b6858",
      "name": "Extract info"
    },
    {
      "parameters": {
        "jsCode": "const results = [];\n\nconst items = $node[\"Detect lead\"].json \n  ? [$node[\"Detect lead\"].json] \n  : $node[\"Detect lead\"].all();\n\nfor (const item of items) {\n\n  // Read AI output safely\n  let raw =\n    item.content?.parts?.[0]?.text ||\n    item.message?.content ||\n    item.message ||\n    \"\";\n\n  try {\n    // Remove markdown wrappers\n    let clean = raw.replace(/```json|```/g, \"\").trim();\n\n    // Parse JSON\n    const data = JSON.parse(clean);\n\n    results.push({\n      json: {\n        lead_stage: data.lead_stage || \"Unqualified\",\n        reason: data.reason || \"No reason returned\",\n        confidence: data.confidence || \"Low\"\n      }\n    });\n\n  } catch (err) {\n\n    results.push({\n      json: {\n        lead_stage: \"Unqualified\",\n        reason: \"Invalid JSON from AI\",\n        confidence: \"Low\"\n      }\n    });\n\n  }\n}\n\nreturn results;\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1952,
        112
      ],
      "id": "5acc364d-f404-47d4-a4f3-3f34ebf3d77e",
      "name": "Extract Data from prev node"
    },
    {
      "parameters": {
        "operation": "appendOrUpdate",
        "documentId": {
          "__rl": true,
          "value": "1IUNIvKOc2s6qmjwrMZLpuhgvvK_py2sXskapsOswS04",
          "mode": "list",
          "cachedResultName": "Lead Qualification System",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1IUNIvKOc2s6qmjwrMZLpuhgvvK_py2sXskapsOswS04/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 954419306,
          "mode": "list",
          "cachedResultName": "Instagram",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1IUNIvKOc2s6qmjwrMZLpuhgvvK_py2sXskapsOswS04/edit#gid=954419306"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Sender ID": "={{ $('Extracts ID').first().json.body.entry[0].messaging[0].sender.id }}",
            "Text": "={{ $('Instagram DMs').first().json.body.entry[0].messaging[0].message.text }}",
            "Date": "={{ $now.toLocaleString('en-IN', { timeZone: 'Asia/Calcutta' }) }}",
            "problem_summary": "={{ $('Format Prompt').item.json.problem_summary }}",
            "need_type": "={{ $('Format Prompt').item.json.need_type }}",
            "lead_score": "={{ $('Format Prompt').item.json.lead_score }}",
            "Lead Stage": "={{ $('Extract Data from prev node').item.json.lead_stage }}",
            "reason": "={{ $('Extract Data from prev node').item.json.reason }}",
            "coach_notes": "={{ $('Format Prompt').item.json.coach_notes }}"
          },
          "matchingColumns": [
            "Sender ID"
          ],
          "schema": [
            {
              "id": "Date",
              "displayName": "Date",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Name",
              "displayName": "Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Email",
              "displayName": "Email",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Sender ID",
              "displayName": "Sender ID",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Text",
              "displayName": "Text",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "problem_summary",
              "displayName": "problem_summary",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "need_type",
              "displayName": "need_type",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "lead_score",
              "displayName": "lead_score",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Lead Stage",
              "displayName": "Lead Stage",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "reason",
              "displayName": "reason",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "coach_notes",
              "displayName": "coach_notes",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2432,
        112
      ],
      "id": "03fd3122-122f-4c09-ab65-e6dd6b6a80ea",
      "name": "Add rows to sheet1",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "3MsYFPOz6gYs3lBk",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1IUNIvKOc2s6qmjwrMZLpuhgvvK_py2sXskapsOswS04",
          "mode": "list",
          "cachedResultName": "Coaches",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1IUNIvKOc2s6qmjwrMZLpuhgvvK_py2sXskapsOswS04/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1589942840,
          "mode": "list",
          "cachedResultName": "Convo history(insta)",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1IUNIvKOc2s6qmjwrMZLpuhgvvK_py2sXskapsOswS04/edit#gid=1589942840"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "AI reply": "={{ $('Format Prompt').item.json.reply }}",
            "User message": "={{ $('Extracts ID').first().json.Text }}",
            "Sender_id": "={{ $('Extracts ID').first().json.body.entry[0].messaging[0].sender.id }}"
          },
          "matchingColumns": [
            "sender_id"
          ],
          "schema": [
            {
              "id": "Sender_id",
              "displayName": "Sender_id",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "AI reply",
              "displayName": "AI reply",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "User message",
              "displayName": "User message",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2192,
        112
      ],
      "id": "fad3d675-ca46-4b0a-8068-36b086ca658e",
      "name": "Add conversations to sheet",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "3MsYFPOz6gYs3lBk",
          "name": "Google Sheets account"
        }
      }
    }
  ],
  "connections": {
    "Simple Memory": {
      "ai_memory": [
        [
          {
            "node": "AI Agent",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent": {
      "main": [
        [
          {
            "node": "Format Prompt",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Instagram DMs": {
      "main": [
        [
          {
            "node": "Extracts ID",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Respond to Webhook",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extracts ID": {
      "main": [
        [
          {
            "node": "If",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If": {
      "main": [
        [],
        [
          {
            "node": "Get previous convo",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Gemini Chat Model4": {
      "ai_languageModel": [
        [
          {
            "node": "Extract Information out",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Checks every 30min": {
      "main": [
        [
          {
            "node": "Get All Meetings",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get All Meetings": {
      "main": [
        [
          {
            "node": "Split out all Meetings",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Split out all Meetings": {
      "main": [
        [
          {
            "node": "Edit start and end time",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit start and end time": {
      "main": [
        [
          {
            "node": "Loop ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop ": {
      "main": [
        [],
        [
          {
            "node": "Checks the time diff ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Checks the time diff ": {
      "main": [
        [
          {
            "node": "Edit required fields in calender",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit required fields in calender": {
      "main": [
        [
          {
            "node": "Check true or false ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch btw hrs": {
      "main": [
        [
          {
            "node": "Send personalized message ( Email )",
            "type": "main",
            "index": 0
          },
          {
            "node": "Send personalized DM",
            "type": "main",
            "index": 0
          },
          {
            "node": "Loop ",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Send personalized message ( Email )",
            "type": "main",
            "index": 0
          },
          {
            "node": "Send personalized DM",
            "type": "main",
            "index": 0
          },
          {
            "node": "Loop ",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Loop ",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Edit only Req Fields",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Send personalized message ( Email )": {
      "main": [
        [
          {
            "node": "Extract Information out",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extract Information out": {
      "main": [
        [
          {
            "node": "Send a Booking email alert",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Send personalized DM": {
      "main": [
        [
          {
            "node": "Send a remainder in Telegram",
            "type": "main",
            "index": 0
          },
          {
            "node": "Send a remainder in Whatsapp",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit only Req Fields": {
      "main": [
        [
          {
            "node": "Get row(s) in sheet4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Check true or false ": {
      "main": [
        [
          {
            "node": "Switch btw hrs",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s) in sheet4": {
      "main": [
        [
          {
            "node": "Message a model1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Divide Lead Details": {
      "main": [
        [
          {
            "node": "Send a message4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Message a model1": {
      "main": [
        [
          {
            "node": "Code in JavaScript",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript": {
      "main": [
        [
          {
            "node": "Divide Lead Details",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model1": {
      "ai_languageModel": [
        [
          {
            "node": "Extract info",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Get last 5 Conversations": {
      "main": [
        [
          {
            "node": "AI Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get previous convo": {
      "main": [
        [
          {
            "node": "Get last 5 Conversations",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Format Prompt": {
      "main": [
        [
          {
            "node": "Detect lead",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Detect lead": {
      "main": [
        [
          {
            "node": "Extract info",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extract info": {
      "main": [
        [
          {
            "node": "Extract Data from prev node",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extract Data from prev node": {
      "main": [
        [
          {
            "node": "Add conversations to sheet",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Add rows to sheet1": {
      "main": [
        [
          {
            "node": "Send reply back in Instagram",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Add conversations to sheet": {
      "main": [
        [
          {
            "node": "Add rows to sheet1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "settings": {
    "executionOrder": "v1"
  },
  "staticData": {
    "node:Checks every 30min": {
      "recurrenceRules": []
    }
  },
  "meta": {
    "templateCredsSetupCompleted": true
  },
  "pinData": {
    "Checks the time diff ": [
      {
        "json": {
          "eventId": null,
          "summary": null,
          "hoursUntilStart": "18hrs"
        }
      }
    ],
    "Edit required fields in calender": [
      {
        "json": {
          "time": "18hrs",
          "summary": "30 Min Meeting between Lumoscale and v vamsi",
          "attendees[1].email": "vamsivk1465@gmail.com",
          "start": {
            "dateTime": "1/11/2025, 8:00:00 pm"
          },
          "creator": {
            "email": "vamsivk1465@gmail.com"
          }
        }
      }
    ],
    "Edit only Req Fields": [
      {
        "json": {
          "attendees[1].email": "vamsivk1465@gmail.com"
        }
      }
    ],
    "Check true or false ": [
      {
        "json": {
          "time": "18hrs",
          "isValid": false
        }
      }
    ],
    "Divide Lead Details": [
      {
        "json": {
          "Lead_Snapshot": "- Name: Vadla Vamsi Krishna  - Email: vamsivk1465@gmail.com  - Date: 2025-10-31T17:06:31.821+01:00  - Lead Stage: Hot  - Lead Score: 1  - Need Type: System / Irrelevant",
          "Conversation_Summary": "The message is an automated notification alerting Vadla Vamsi Krishna about a login to their account from a new device. It asks if the login was performed by them. There is no indication of personal intent or coaching-related inquiry.",
          "Problem_Goal": "This is a system-generated security alert regarding a login attempt and does not represent a coaching-related problem or goal.",
          "Context_Insights": "The reason field clarifies that this message is an automated login alert and unrelated to coaching needs or genuine human interest. Coach notes explicitly instruct to ignore this message as it is not a potential lead for coaching engagement.",
          "Preparation_for_Coach": "- The coach does not need to prepare for engagement as this is not a genuine lead.  - No call or communication is necessary, and no coaching materials or stories need to be prepared.  - Tone or style is irrelevant in this case because no outreach is recommended.",
          "Smart_Questions": "Not applicable â€” this lead is system-generated and not relevant for coaching interaction.",
          "Recommended_Next_Step": "Ignore this message. Mark as a system notification and do not proceed with any coaching outreach.",
          "Summary": "This lead, Vadla Vamsi Krishna, has sent an automated login alert message that is unrelated to coaching. Despite the â€œHotâ€ lead stage label, the very low lead score and contextual details denote it as an irrelevant system message. The coach should disregard and take no action.",
          "Name": "Vadla Vamsi Krishna",
          "Email": "vamsivk1465@gmail.com",
          "Date": "2025-10-31T17:06:31.821+01:00",
          "Lead_Stage": "Hot",
          "Lead_Score": "1",
          "Need_Type": "System / Irrelevant"
        }
      }
    ],
    "Message a model1": [
      {
        "json": {
          "index": 0,
          "message": {
            "role": "assistant",
            "content": "**Pre-Call Brief**\n\n---\n\n**1. Lead Snapshot**  \n- Name: Vadla Vamsi Krishna  \n- Email: vamsivk1465@gmail.com  \n- Date: 2025-10-31T17:06:31.821+01:00  \n- Lead Stage: Hot  \n- Lead Score: 1  \n- Need Type: System / Irrelevant  \n\n---\n\n**2. Conversation Summary**  \nThe message is an automated notification alerting Vadla Vamsi Krishna about a login to their account from a new device. It asks if the login was performed by them. There is no indication of personal intent or coaching-related inquiry.\n\n---\n\n**3. Problem / Goal**  \nThis is a system-generated security alert regarding a login attempt and does not represent a coaching-related problem or goal.\n\n---\n\n**4. Context & Insights**  \nThe reason field clarifies that this message is an automated login alert and unrelated to coaching needs or genuine human interest. Coach notes explicitly instruct to ignore this message as it is not a potential lead for coaching engagement.\n\n---\n\n**5. Preparation for Coach**  \n- The coach does not need to prepare for engagement as this is not a genuine lead.  \n- No call or communication is necessary, and no coaching materials or stories need to be prepared.  \n- Tone or style is irrelevant in this case because no outreach is recommended.\n\n---\n\n**6. Smart Questions to Ask**  \n*Not applicable* â€” this lead is system-generated and not relevant for coaching interaction.\n\n---\n\n**7. Recommended Next Step**  \nIgnore this message. Mark as a system notification and do not proceed with any coaching outreach.\n\n---\n\n**Summary:**  \nThis lead, Vadla Vamsi Krishna, has sent an automated login alert message that is unrelated to coaching. Despite the â€œHotâ€ lead stage label, the very low lead score and contextual details denote it as an irrelevant system message. The coach should disregard and take no action.",
            "refusal": null,
            "annotations": []
          },
          "logprobs": null,
          "finish_reason": "stop"
        }
      }
    ],
    "Code in JavaScript": [
      {
        "json": {
          "Lead_Snapshot": "- Name: Vadla Vamsi Krishna  - Email: vamsivk1465@gmail.com  - Date: 2025-10-31T17:06:31.821+01:00  - Lead Stage: Hot  - Lead Score: 1  - Need Type: System / Irrelevant",
          "Conversation_Summary": "The message is an automated notification alerting Vadla Vamsi Krishna about a login to their account from a new device. It asks if the login was performed by them. There is no indication of personal intent or coaching-related inquiry.",
          "Problem_Goal": "This is a system-generated security alert regarding a login attempt and does not represent a coaching-related problem or goal.",
          "Context_Insights": "The reason field clarifies that this message is an automated login alert and unrelated to coaching needs or genuine human interest. Coach notes explicitly instruct to ignore this message as it is not a potential lead for coaching engagement.",
          "Preparation_for_Coach": "- The coach does not need to prepare for engagement as this is not a genuine lead.  - No call or communication is necessary, and no coaching materials or stories need to be prepared.  - Tone or style is irrelevant in this case because no outreach is recommended.",
          "Smart_Questions": "Not applicable â€” this lead is system-generated and not relevant for coaching interaction.",
          "Recommended_Next_Step": "Ignore this message. Mark as a system notification and do not proceed with any coaching outreach.",
          "Summary": "This lead, Vadla Vamsi Krishna, has sent an automated login alert message that is unrelated to coaching. Despite the â€œHotâ€ lead stage label, the very low lead score and contextual details denote it as an irrelevant system message. The coach should disregard and take no action."
        }
      }
    ]
  },
  "versionId": "76f4cfda-8d1e-4c83-9299-f0f0ab58a9e5",
  "triggerCount": 2,
  "shared": [
    {
      "createdAt": "2025-12-04T19:45:21.787Z",
      "updatedAt": "2025-12-04T19:45:21.787Z",
      "role": "workflow:owner",
      "workflowId": "STia7TWDgzrXBnB8",
      "projectId": "VDyoKZWt3i5eAZSO"
    }
  ],
  "tags": []
}