{
  "createdAt": "2025-11-16T07:33:05.832Z",
  "updatedAt": "2025-12-05T18:16:01.000Z",
  "id": "C8Mvab5ljKseAAcA",
  "name": "Website Automation",
  "active": false,
  "isArchived": false,
  "nodes": [
    {
      "parameters": {
        "formTitle": "Trusted by coaches and agencies",
        "formDescription": "Free audit done by automation experts",
        "formFields": {
          "values": [
            {
              "fieldLabel": "Name",
              "placeholder": "Enter your name",
              "requiredField": true
            },
            {
              "fieldLabel": "Email",
              "placeholder": "Enter your email",
              "requiredField": true
            },
            {
              "fieldLabel": "Whatsapp number",
              "fieldType": "number",
              "placeholder": "Number",
              "requiredField": true
            },
            {
              "fieldLabel": "Business type",
              "requiredField": true
            },
            {
              "fieldLabel": "Monthly revenue range",
              "fieldType": "dropdown",
              "fieldOptions": {
                "values": [
                  {
                    "option": "2k"
                  },
                  {
                    "option": "3k"
                  }
                ]
              },
              "requiredField": true
            },
            {
              "fieldLabel": "What's your biggest challenge right now?",
              "placeholder": "Message",
              "requiredField": true
            },
            {
              "fieldLabel": "How soon do you want to solve this",
              "fieldType": "dropdown",
              "fieldOptions": {
                "values": [
                  {
                    "option": "Immediate"
                  },
                  {
                    "option": "Week later"
                  },
                  {
                    "option": "month later"
                  },
                  {
                    "option": "Not urgent"
                  }
                ]
              },
              "requiredField": true
            },
            {
              "fieldLabel": "What is your biggest goal in the next 90 days",
              "requiredField": true
            }
          ]
        },
        "options": {
          "appendAttribution": false,
          "buttonLabel": "Book a Call",
          "ignoreBots": true,
          "customCss": "<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n<meta charset=\"UTF-8\" />\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" />\n<title>Lumoscale Lead Form</title>\n<style>\n:root {\n\t--font-family: 'Open Sans', sans-serif;\n\t--font-weight-normal: 400;\n\t--font-weight-bold: 600;\n\t--font-size-body: 14px;\n\t--font-size-label: 14px;\n\t--font-size-header: 20px;\n\t--color-background: #fbfcfe;\n\t--color-card-bg: #ffffff;\n\t--color-card-border: #dbdfe7;\n\t--color-card-shadow: rgba(99, 77, 255, 0.06);\n\t--color-header: #525356;\n\t--color-label: #555555;\n\t--color-input-border: #dbdfe7;\n\t--color-input-text: #333;\n\t--color-focus-border: #5a4cc2;\n\t--color-submit-btn-bg: #ff6d5a;\n\t--color-submit-btn-text: #ffffff;\n\t--color-html-link: #ff6d5a;\n\t--color-error: #ea1f30;\n\t--border-radius-card: 8px;\n\t--border-radius-input: 6px;\n\t--box-shadow-card: 0 6px 18px var(--color-card-shadow);\n}\n\nbody {\n\tfont-family: var(--font-family);\n\tbackground: var(--color-background);\n\tdisplay: flex;\n\tjustify-content: center;\n\talign-items: center;\n\tmin-height: 100vh;\n\tpadding: 20px;\n}\n\n.form-card {\n\tbackground: var(--color-card-bg);\n\tborder: 1px solid var(--color-card-border);\n\tbox-shadow: var(--box-shadow-card);\n\tborder-radius: var(--border-radius-card);\n\twidth: 100%;\n\tmax-width: 420px;\n\tpadding: 32px;\n}\n\n.form-header {\n\ttext-align: center;\n\tcolor: var(--color-header);\n\tfont-size: var(--font-size-header);\n\tfont-weight: var(--font-weight-bold);\n\tmargin-bottom: 12px;\n}\n\n.form-subtext {\n\ttext-align: center;\n\tcolor: #7e8186;\n\tfont-size: 13px;\n\tmargin-bottom: 24px;\n}\n\n.form-group {\n\tmargin-bottom: 16px;\n}\n\nlabel {\n\tdisplay: block;\n\tmargin-bottom: 6px;\n\tcolor: var(--color-label);\n\tfont-size: var(--font-size-label);\n}\n\ninput, textarea, select {\n\twidth: 100%;\n\tpadding: 12px;\n\tborder: 1px solid var(--color-input-border);\n\tborder-radius: var(--border-radius-input);\n\tfont-size: var(--font-size-body);\n\tcolor: var(--color-input-text);\n\tbackground-color: #fff;\n\ttransition: border 0.3s;\n}\n\ninput:focus, textarea:focus, select:focus {\n\toutline: none;\n\tborder-color: var(--color-focus-border);\n\tbox-shadow: 0 0 0 3px rgba(90, 76, 194, 0.1);\n}\n\nbutton {\n\twidth: 100%;\n\tbackground: var(--color-submit-btn-bg);\n\tcolor: var(--color-submit-btn-text);\n\tpadding: 14px;\n\tfont-size: var(--font-size-label);\n\tfont-weight: var(--font-weight-bold);\n\tborder: none;\n\tborder-radius: var(--border-radius-input);\n\tcursor: pointer;\n\ttransition: 0.3s;\n}\n\nbutton:hover {\n\tbackground: #ff543e;\n}\n\nfooter {\n\ttext-align: center;\n\tmargin-top: 16px;\n\tfont-size: 12px;\n\tcolor: #888;\n}\n</style>\n</head>\n<body>\n\n<div class=\"form-card\">\n\t<h2 class=\"form-header\">Get Your Free Automation Audit</h2>\n\t<p class=\"form-subtext\">See how we can automate your lead generation, qualification, and onboarding.</p>\n\t\n\t<form>\n\t\t<div class=\"form-group\">\n\t\t\t<label for=\"name\">Full Name</label>\n\t\t\t<input type=\"text\" id=\"name\" placeholder=\"Enter your name\" required>\n\t\t</div>\n\n\t\t<div class=\"form-group\">\n\t\t\t<label for=\"email\">Email</label>\n\t\t\t<input type=\"email\" id=\"email\" placeholder=\"Enter your email\" required>\n\t\t</div>\n\n\t\t<div class=\"form-group\">\n\t\t\t<label for=\"business\">Business Type / Niche</label>\n\t\t\t<select id=\"business\">\n\t\t\t\t<option value=\"\">Select...</option>\n\t\t\t\t<option>Coach / Consultant</option>\n\t\t\t\t<option>Agency Owner</option>\n\t\t\t\t<option>Real Estate</option>\n\t\t\t\t<option>Law / Legal</option>\n\t\t\t\t<option>Other</option>\n\t\t\t</select>\n\t\t</div>\n\n\t\t<div class=\"form-group\">\n\t\t\t<label for=\"pain\">Biggest Challenge Right Now</label>\n\t\t\t<textarea id=\"pain\" rows=\"3\" placeholder=\"E.g., Too many unqualified leads or missed follow-ups\"></textarea>\n\t\t</div>\n\n\t\t<button type=\"submit\">Submit</button>\n\t</form>\n\n\t<footer>Powered by Lumoscale Automations</footer>\n</div>\n\n</body>\n</html>\n"
        }
      },
      "type": "n8n-nodes-base.formTrigger",
      "typeVersion": 2.3,
      "position": [
        -3488,
        -688
      ],
      "id": "0481a309-351d-44da-9866-e5ba8533df73",
      "name": "Website Signup or Webinar Signup",
      "webhookId": "4be5de2b-37e1-4104-949c-1f34b061df64"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "323ad272-08e7-462f-9774-efe6946dfba0",
              "leftValue": "={{ $json.Email }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "notExists",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -1952,
        -688
      ],
      "id": "51c5715d-e19a-445f-96b7-acec735a1897",
      "name": "If duplicates Found vs Not Found"
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1IUNIvKOc2s6qmjwrMZLpuhgvvK_py2sXskapsOswS04",
          "mode": "list",
          "cachedResultName": "Coaches",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1IUNIvKOc2s6qmjwrMZLpuhgvvK_py2sXskapsOswS04/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "Form",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1IUNIvKOc2s6qmjwrMZLpuhgvvK_py2sXskapsOswS04/edit#gid=0"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "Email",
              "lookupValue": "={{ $json.Email }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        -2208,
        -688
      ],
      "id": "0fd30ae7-e33a-429c-bb68-92536b3e901b",
      "name": "Check duplicates",
      "alwaysOutputData": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "3MsYFPOz6gYs3lBk",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "8b3ce1dd-7bf9-4a69-ac98-e11ab5b5050a",
              "name": "Name",
              "value": "={{ $json.Name }}",
              "type": "string"
            },
            {
              "id": "167f58be-18af-4382-94b6-b7b8d73ad2a2",
              "name": "Email",
              "value": "={{ $json.Email }}",
              "type": "string"
            },
            {
              "id": "8da05d43-4e19-4bb7-bc4a-3650033986ba",
              "name": "Whatsapp number",
              "value": "={{ $json['Whatsapp number'] }}",
              "type": "number"
            },
            {
              "id": "e9afaa00-8635-4999-87c7-3846579abee2",
              "name": "Business type",
              "value": "={{ $json['Business type'] }}",
              "type": "string"
            },
            {
              "id": "18952807-fab2-4977-af47-3621f832c6af",
              "name": "Monthly revenue range",
              "value": "={{ $json['Monthly revenue range'] }}",
              "type": "string"
            },
            {
              "id": "08bd423a-9935-4938-9751-9d945f56d8f6",
              "name": "What's your biggest challenge right now?",
              "value": "={{ $json['What\\'s your biggest challenge right now?'] }}",
              "type": "string"
            },
            {
              "id": "d05a24f1-bd9d-4aa8-8e6f-c7cba26cd843",
              "name": "How soon do you want to solve this",
              "value": "={{ $json['How soon do you want to solve this'] }}",
              "type": "string"
            },
            {
              "id": "654eec57-8fcd-4da2-9cc0-6d0dbf3e8e74",
              "name": "What is your biggest goal in the next 90 days",
              "value": "={{ $json['What is your biggest goal in the next 90 days'] }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -3264,
        -688
      ],
      "id": "110f4223-33f4-43b6-8063-8fbf8d215c4e",
      "name": "Edit Req Fields for Form"
    },
    {
      "parameters": {
        "jsCode": "for (const item of $input.all()) {\n\n  // Read AI output safely\n  let raw = item.json.content?.parts?.[0]?.text || item.json.message || \"\";\n\n  // Parse JSON\n  let data = {};\n  try {\n    data = JSON.parse(raw);\n  } catch (e) {\n    console.error(\"Invalid JSON format\");\n  }\n\n  // Overwrite output with clean structured fields only\n  item.json = {\n    core_pain: data.CorePain || \"\",\n    need_type: data.NeedType || \"\",\n    emotion: data.Emotion || \"\",\n    pain_intensity: data.PainIntensity || 0,\n    committed_words: data.CommittedWordsCount || 0,\n    urgency_flag: data.UrgencyFlag || false,\n    action_words: data.ActionWordsCount || 0,\n    victim_language: data.VictimLanguage || false,\n    revenue_score: data.RevenueScore || 0,\n    intent_score: data.IntentScore || 0,\n    clarity_score: data.ClarityScore || 0,\n    goal_quality_score: data.GoalQualityScore || 0,\n    coach_notes: data.Notes || \"\"\n  };\n\n}\n\nreturn $input.all();\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -2688,
        -688
      ],
      "id": "07cf90a8-7992-4ac5-9bb7-8ec3b6b15449",
      "name": "Code in JavaScript"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "2350c7a9-6b70-4dfb-90ba-2bfa6ca37f4d",
              "name": "core_pain",
              "value": "={{ $json.core_pain }}",
              "type": "string"
            },
            {
              "id": "2dd8e177-b39f-4c5a-a069-1a9858b7a256",
              "name": "need_type",
              "value": "={{ $json.need_type }}",
              "type": "string"
            },
            {
              "id": "7870b5d9-604c-44b7-917b-d6874c195a79",
              "name": "emotion",
              "value": "={{ $json.emotion }}",
              "type": "string"
            },
            {
              "id": "c2870d81-c2f7-4fcc-86d4-d27e995475b7",
              "name": "pain_intensity",
              "value": "={{ $json.pain_intensity }}",
              "type": "number"
            },
            {
              "id": "6e689456-24f1-434b-8d8e-5231e9b70d65",
              "name": "committed_words",
              "value": "={{ $json.committed_words }}",
              "type": "number"
            },
            {
              "id": "6bc3eebc-d1d6-4acb-b997-4637db34a7dd",
              "name": "urgency_flag",
              "value": "={{ $json.urgency_flag }}",
              "type": "boolean"
            },
            {
              "id": "5f6a6aaa-2478-438c-9866-ecae53619494",
              "name": "action_words",
              "value": "={{ $json.action_words }}",
              "type": "number"
            },
            {
              "id": "42f98ec6-22d4-4e50-aa53-07233b8c59b2",
              "name": "victim_language",
              "value": "={{ $json.victim_language }}",
              "type": "boolean"
            },
            {
              "id": "acf95a6f-bed0-4768-b81b-8b1fcc6f22d4",
              "name": "revenue_score",
              "value": "={{ $json.revenue_score }}",
              "type": "number"
            },
            {
              "id": "a3fbe06c-c4c3-4659-a6ef-94f8b0a15535",
              "name": "intent_score",
              "value": "={{ $json.intent_score }}",
              "type": "number"
            },
            {
              "id": "78ba03ff-a05c-4832-963b-dd121eac1277",
              "name": "clarity_score",
              "value": "={{ $json.clarity_score }}",
              "type": "number"
            },
            {
              "id": "9110624c-e8aa-4e0d-87f1-c39e8d8eaabb",
              "name": "goal_quality_score",
              "value": "={{ $json.goal_quality_score }}",
              "type": "number"
            },
            {
              "id": "98fe0447-52e1-449a-b9f0-ca131d3576a8",
              "name": "coach_notes",
              "value": "={{ $json.coach_notes }}",
              "type": "string"
            },
            {
              "id": "49591807-25b2-4a31-a430-415e86dd22ab",
              "name": "Name",
              "value": "={{ $('Edit Req Fields for Form').first().json.Name }}",
              "type": "string"
            },
            {
              "id": "3d23a6a7-0c26-4bcd-ac56-6947a68404d3",
              "name": "Email",
              "value": "={{ $('Edit Req Fields for Form').first().json.Email }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -2448,
        -688
      ],
      "id": "ac51f998-0ada-407c-b204-e40b527b688e",
      "name": "Edit Fields"
    },
    {
      "parameters": {
        "jsCode": "for (const item of $input.all()) {\n\n  // Read AI output safely\n  let raw =\n    item.json.content?.parts?.[0]?.text ||\n    item.json.message?.content ||\n    item.json.message ||\n    \"\";\n\n  // Normalize line breaks\n  raw = raw.replace(/\\\\n/g, \"\\n\");\n\n  // Extract helper\n  const extract = (key) => {\n    const regex = new RegExp(`${key}:\\\\s*(.+)`, \"i\");\n    const match = raw.match(regex);\n    return match ? match[1].trim() : \"\";\n  };\n\n  // Assign clean output\n  item.json = {\n    name: extract(\"Name\"),\n    email: extract(\"Email\"),\n    lead_stage: extract(\"Lead Stage\"),\n    reason: extract(\"Reason\"),\n    coach_notes: extract(\"Coach Notes\")\n  };\n\n}\n\nreturn $input.all();\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -3152,
        -144
      ],
      "id": "0f7d9487-ebb6-44b1-833a-4be7e25bb77a",
      "name": "Code in JavaScript1"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "82dfc6ac-0af4-44e0-99ad-f556be6f2a87",
              "name": "name",
              "value": "={{ $json.name }}",
              "type": "string"
            },
            {
              "id": "7433e411-0b73-4486-a4c8-ec774a475bdf",
              "name": "email",
              "value": "={{ $json.email }}",
              "type": "string"
            },
            {
              "id": "f6c13b9c-f986-455f-b06f-542588e68756",
              "name": "lead_stage",
              "value": "={{ $json.lead_stage }}",
              "type": "string"
            },
            {
              "id": "2b90c612-331c-43e6-ab4a-68405fbb634a",
              "name": "reason",
              "value": "={{ $json.reason }}",
              "type": "string"
            },
            {
              "id": "5a8f2d38-19a1-45c6-83d4-ef3defa981ce",
              "name": "coach_notes",
              "value": "={{ $json.coach_notes }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -2928,
        -144
      ],
      "id": "9cb36807-6e93-425b-a17b-c38bca673261",
      "name": "Edit Fields1"
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1IUNIvKOc2s6qmjwrMZLpuhgvvK_py2sXskapsOswS04",
          "mode": "list",
          "cachedResultName": "Coaches",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1IUNIvKOc2s6qmjwrMZLpuhgvvK_py2sXskapsOswS04/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "Website Forms",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1IUNIvKOc2s6qmjwrMZLpuhgvvK_py2sXskapsOswS04/edit#gid=0"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Email": "={{ $json.Email }}",
            "Date": "={{ new Date().toLocaleDateString('en-IN', { timeZone: 'Asia/Kolkata' }) }}",
            "Name": "={{ $json.Name }}"
          },
          "matchingColumns": [
            "Email"
          ],
          "schema": [
            {
              "id": "Date",
              "displayName": "Date",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Name",
              "displayName": "Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Email",
              "displayName": "Email",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Problem Summary",
              "displayName": "Problem Summary",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Need type",
              "displayName": "Need type",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Intent Score",
              "displayName": "Intent Score",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Lead Stage",
              "displayName": "Lead Stage",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Reason",
              "displayName": "Reason",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Pain Intensity",
              "displayName": "Pain Intensity",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Coach notes",
              "displayName": "Coach notes",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        -1680,
        -848
      ],
      "id": "48583ed9-d6bb-4db8-8dea-7e2d3e8ec63c",
      "name": "Update Form Sheet 1",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "3MsYFPOz6gYs3lBk",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1IUNIvKOc2s6qmjwrMZLpuhgvvK_py2sXskapsOswS04",
          "mode": "list",
          "cachedResultName": "Coaches",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1IUNIvKOc2s6qmjwrMZLpuhgvvK_py2sXskapsOswS04/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "Websiteforms",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1IUNIvKOc2s6qmjwrMZLpuhgvvK_py2sXskapsOswS04/edit#gid=0"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Name": "={{ $('Switch').item.json.name }}",
            "Email": "={{ $('Switch').item.json.email }}",
            "Need type": "={{ $('Edit Fields').first().json.need_type }}",
            "Lead Stage": "={{ $('Code in JavaScript1').first().json.lead_stage }}",
            "Reason": "={{ $('Code in JavaScript1').first().json.reason }}",
            "Coach notes": "={{ $('Edit Fields1').item.json.coach_notes }}",
            "Date": "={{ $now }}",
            "Problem Summary": "={{ $('Edit Fields').first().json.core_pain }}",
            "Intent Score": "={{ $('Edit Fields').first().json.intent_score }}",
            "Pain Intensity": "={{ $('Edit Fields').first().json.pain_intensity }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "Date",
              "displayName": "Date",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Name",
              "displayName": "Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Email",
              "displayName": "Email",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Problem Summary",
              "displayName": "Problem Summary",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Need type",
              "displayName": "Need type",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Intent Score",
              "displayName": "Intent Score",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Lead Stage",
              "displayName": "Lead Stage",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Reason",
              "displayName": "Reason",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Pain Intensity",
              "displayName": "Pain Intensity",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Coach notes",
              "displayName": "Coach notes",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        -1792,
        -208
      ],
      "id": "46827ef7-7206-4f27-86cf-96d5e9d63dd4",
      "name": "Append row in sheet",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "3MsYFPOz6gYs3lBk",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.lead_stage }}",
                    "rightValue": "Hot",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "0e3762bf-b17e-495d-a9f7-61904bc8b577"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "Hot"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "8cd1127e-6ed2-4800-8bc8-35a2687fba11",
                    "leftValue": "={{ $json.lead_stage }}",
                    "rightValue": "Warm",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "Warm"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "d378bd21-f613-4a55-ad6e-b9a061adc0e8",
                    "leftValue": "={{ $json.lead_stage }}",
                    "rightValue": "Cold",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "Cold"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "a895fc85-1600-4a1b-94fa-0baaa00ebbbe",
                    "leftValue": "={{ $json.lead_stage }}",
                    "rightValue": "Unqualified",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "Unqualified"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        -2608,
        272
      ],
      "id": "568b91d1-049d-4f42-82a2-5879ef5526b4",
      "name": "Switch"
    },
    {
      "parameters": {
        "sendTo": "={{ $json.email }}",
        "subject": "New Lead",
        "message": "=<!doctype html>\n<html>\n  <body style=\"margin:0; padding:0; background:#f6f7fb; font-family:Arial, sans-serif;\">\n\n    <div style=\"max-width:600px; margin:30px auto; padding:20px;\">\n\n      <!-- Colorful Box -->\n      <div style=\"background:#ffffff; border-left:6px solid #ff6d5a; padding:22px 26px; border-radius:12px; box-shadow:0 4px 14px rgba(0,0,0,0.08);\">\n\n        <p style=\"font-size:15px; color:#111; margin:0 0 14px 0;\">\n          Hi {{ $json.name }},\n        </p>\n\n        <p style=\"font-size:15px; color:#333; line-height:1.6; margin:0 0 14px 0;\">\n          I read your note about <strong>{{ $('Code in JavaScript').first().json.problem_summary }}</strong> and I am confident we can make progress quickly.\n        </p>\n\n        <p style=\"font-size:15px; color:#333; line-height:1.6; margin:0 0 22px 0;\">\n          Here is my calendar link so we can talk and create your action plan.\n        </p>\n\n        <div style=\"text-align:left; margin-bottom:26px;\">\n          <a href=\"{{calendar_link}}\"\n            style=\"background:#ff6d5a; padding:12px 22px; color:#ffffff; text-decoration:none; \n                   font-size:15px; font-weight:bold; border-radius:6px; display:inline-block;\">\n            Book Call\n          </a>\n        </div>\n\n        <p style=\"font-size:14px; color:#555; margin:0 0 18px 0; line-height:1.5;\">\n          If the time slots do not fit, reply and I will adjust the schedule.\n        </p>\n\n        <p style=\"font-size:12px; color:#999; margin-top:28px;\">\n          Lumoscale Automations\n        </p>\n\n      </div>\n\n    </div>\n\n  </body>\n</html>\n",
        "options": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        -2032,
        -208
      ],
      "id": "e580605b-77ed-41bb-b425-5963c53ce4a1",
      "name": "Hot Lead",
      "webhookId": "60502eb8-e3ed-409e-a9b8-7235cfc5885a",
      "credentials": {
        "gmailOAuth2": {
          "id": "UbWO1LFfZ6s8MzMA",
          "name": "Gmail account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "oAuth2",
        "select": "channel",
        "channelId": {
          "__rl": true,
          "value": "C09PV3DSRJQ",
          "mode": "list",
          "cachedResultName": "n8n"
        },
        "messageType": "block",
        "blocksUi": "={\n  \"blocks\": [\n    {\n      \"type\": \"header\",\n      \"text\": {\n        \"type\": \"plain_text\",\n        \"text\": \"ðŸ”¥ Hot Lead Alert\"\n      }\n    },\n    {\n      \"type\": \"section\",\n      \"text\": {\n        \"type\": \"mrkdwn\",\n        \"text\": \"*Name*: {{ $json.name }}\\n*Email*: {{ $json.email }}\\n*Problem*: {{ $('Edit Fields').item.json.problem_summary }}\\n*Need Type*: {{ $('Edit Fields').item.json.need_type }}\\n*Intensity*: {{ $('Edit Fields').item.json.pain_intensity }}\\n*Reason*: {{ $json.reason }}\\n*Coach Notes*: {{ $json.coach_notes }}\"\n      }\n    },\n    {\n      \"type\": \"divider\"\n    }\n  ]\n}\n",
        "text": "New",
        "otherOptions": {
          "includeLinkToWorkflow": false,
          "unfurl_links": false,
          "unfurl_media": false
        }
      },
      "type": "n8n-nodes-base.slack",
      "typeVersion": 2.3,
      "position": [
        -2048,
        -32
      ],
      "id": "01ad7751-0ab8-4639-99db-a2ce09b4fd82",
      "name": "Hot Slack Message",
      "webhookId": "82b90f26-e9d7-4045-a8a8-cc5473612c04",
      "credentials": {
        "slackOAuth2Api": {
          "id": "Rb7HyhAgq0iIU3TT",
          "name": "Slack account"
        }
      }
    },
    {
      "parameters": {
        "modelId": {
          "__rl": true,
          "value": "models/gemini-2.5-flash-lite",
          "mode": "list",
          "cachedResultName": "models/gemini-2.5-flash-lite"
        },
        "messages": {
          "values": [
            {
              "content": "=# Lead Signal Extraction Prompt\n\n## ROLE\nYou are a Lead Qualification AI for a coaching or service business.  \nYour job is to extract psychological and buying signals from lead form submissions.\n\nYou must:\n- Detect urgency, intent, and readiness\n- Measure emotional state\n- Evaluate clarity and seriousness\n- Recommend next steps for the coach\n- Never classify the lead as hot, warm, or cold\n- Never explain your reasoning\n- Output decision signals and one clear action paragraph only\n\n---\n\n## INPUT PROVIDED\n\nYou will receive:\n\n- Name: {{ $json.Name }}\n- Email: {{ $json.Email }}\n- Phone: {{ $json.Email }}\n- Business type: {{ $json['Business type'] }}\n- Monthly revenue range: {{ $json['Monthly revenue range'] }}\n- Biggest challenge: {{ $json['What\\'s your biggest challenge right now?'] }}\n- Urgency timeline: {{ $json['How soon do you want to solve this'] }}\n- 90 day goal: {{ $json['What is your biggest goal in the next 90 days'] }}\n- Timestamp: {{ $now }}\n\n---\n\n## YOUR TASK  \nAnalyze the form and extract structured signals for automation and sales.\n\n---\n\n## SIGNALS AND EXAMPLES\n\n### 1) Core Pain  \nIdentify the real problem behind the words.\n\nExamples:\n- \"Not getting enough qualified leads\"\n- \"Struggling to convert leads into clients\"\n- \"No predictable income\"\n- \"Overwhelmed managing everything alone\"\n\nOutput one short sentence.\n\n---\n\n### 2) Primary Need Type  \nChoose one category that matches the problem.\n\nOptions and examples:\n- marketing â†’ traffic, leads, visibility\n- sales â†’ converting, closing, objections\n- systems â†’ processes, operations, backend\n- automation â†’ tools, workflows, AI\n- mindset â†’ fear, confidence, burnout\n- finance â†’ pricing, cash flow\n- productivity â†’ focus, performance\n- time management â†’ overwork, chaos\n- career â†’ direction and role confusion\n- business â†’ strategy, growth\n- other â†’ anything that does not fit\n\n---\n\n### 3) Emotional Tone  \nChoose the emotional feeling from the wording.\n\nExamples:\n- hopeful â†’ \"I want to grow\"\n- confused â†’ \"I don't know what to do\"\n- stressed â†’ \"I am tired of trying\"\n- overwhelmed â†’ \"Too much is happening\"\n- positive â†’ \"Things are improving\"\n- negative â†’ \"Nothing works\"\n- neutral â†’ emotionally flat\n\nChoose one.\n\n---\n\n### 4) Pain Intensity (1â€“5)  \nScore emotional and business pressure.\n\nExamples:\n- 1 â†’ \"Just curious\"\n- 3 â†’ \"I want improvement\"\n- 5 â†’ \"I need this solved now\"\n\n---\n\n### 5) Commitment Words Count  \nCount buying language used.\n\nExamples:\n- \"I am ready to invest\" = 2  \n- \"I want to start and build\" = 2  \n- No commitment words = 0  \n\nWords:\nready, start, invest, hire, schedule, pay, launch, build, scale, close\n\n---\n\n### 6) Urgency Flag  \nTrue when urgency appears.\n\nExample true:\n- \"Immediate\"\n- \"Now\"\n- \"This week\"\n\nExample false:\n- \"Whenever\"\n- \"Someday\"\n- \"In future\"\n\n---\n\n### 7) Action Words Count  \nCount past effort.\n\nExamples:\n- \"I tried Facebook ads\" = 1  \n- \"I tested two offers and hired a freelancer\" = 3  \n\nWords:\ntried, tested, launched, hired, executed, implemented, failed, learned, applied\n\n---\n\n### 8) Victim Mindset  \nTrue if blame or helpless language appears.\n\nExample true:\n- \"Market is bad\"\n- \"Clients never respond\"\n- \"Nothing works for me\"\n\nExample false:\n- \"I need help fixing this\"\n- \"I want to improve\"\n\n---\n\n### 9) Revenue Strength (1â€“5)  \nBased on income stability.\n\nExamples:\n- 1 â†’ no income mentioned\n- 3 â†’ small or unstable income\n- 5 â†’ strong revenue\n\n---\n\n### 10) Intent Score (1â€“5)  \nHow soon they want action.\n\nExamples:\n- 1 â†’ browsing\n- 3 â†’ problem aware\n- 5 â†’ buyer intent\n\n---\n\n### 11) Clarity Score (1â€“5)  \nHow well problem is stated.\n\nExamples:\n- 1 â†’ \"I need help\"\n- 3 â†’ \"Not getting leads\"\n- 5 â†’ \"Need 5 clients in 30 days\"\n\n---\n\n### 12) Goal Quality (1â€“5)  \nHow measurable the goal is.\n\nExamples:\n- 1 â†’ \"I want success\"\n- 3 â†’ \"I want more income\"\n- 5 â†’ \"Close 5 deals in 90 days\"\n\n---\n\n### 13) Notes (Instruction Paragraph)\n\nWrite one paragraph telling the coach exactly what to do and what the client should prepare.\n\nExamples:\n\nFor urgent clients  \nAsk the client to prepare their current lead sources, conversion numbers, and pricing so the session can focus on identifying leaks and building an action plan.\n\nFor early stage clients  \nSuggest sending educational resources and inviting them to a strategy call to clarify goals before discussing offers.\n\n---\n\n## OUTPUT FORMAT (STRICT JSON)\n\nReturn JSON only:\n\n{\n  \"CorePain\": \"\",\n  \"NeedType\": \"\",\n  \"Emotion\": \"\",\n  \"PainIntensity\": 0,\n  \"CommittedWordsCount\": 0,\n  \"UrgencyFlag\": false,\n  \"ActionWordsCount\": 0,\n  \"VictimLanguage\": false,\n  \"RevenueScore\": 0,\n  \"IntentScore\": 0,\n  \"ClarityScore\": 0,\n  \"GoalQualityScore\": 0,\n  \"Notes\": \"\"\n}\n\n---\n\n## RULES\n\n- No explanations\n- JSON only\n- No classification\n- One paragraph in Notes\n- Be decisive\n"
            }
          ]
        },
        "jsonOutput": true,
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.googleGemini",
      "typeVersion": 1,
      "position": [
        -3056,
        -688
      ],
      "id": "9e99a7a9-964d-462e-8e0d-cd6ebc705931",
      "name": "Message a model4",
      "credentials": {
        "googlePalmApi": {
          "id": "Gq3qNdXZmlzVb7Jg",
          "name": "Google Gemini(PaLM) Api account"
        }
      }
    },
    {
      "parameters": {
        "modelId": {
          "__rl": true,
          "value": "models/gemini-2.5-flash-lite",
          "mode": "list",
          "cachedResultName": "models/gemini-2.5-flash-lite"
        },
        "messages": {
          "values": [
            {
              "content": "=# Lead Stage Classification Prompt\n\n## ROLE\nYou are a Lead Qualification AI Assistant for a coaching business.  \nYour job is to classify one lead as Hot, Warm, Cold, or Unqualified.\n\nYou think like an experienced coach and judge urgency, emotional pressure, ownership, seriousness, intent, and readiness to change.\n\n---\n\n## INPUT YOU WILL RECEIVE\n\nYou will receive these fields from Edit Fields:\n\n- Name: {{ $('Edit Fields').first().json.Name }}\n- Email: {{ $('Edit Fields').first().json.Email }}\n- Core Pain: {{ $('Edit Fields').first().json.core_pain }}\n- Need Type: {{ $('Edit Fields').first().json.need_type }}\n- Emotion: {{ $('Edit Fields').first().json.emotion }}\n- Pain Intensity: {{ $('Edit Fields').first().json.pain_intensity }}\n- Commitment Count: {{ $('Edit Fields').first().json.committed_words }}\n- Urgency Flag: {{ $('Edit Fields').first().json.urgency_flag }}\n- Action Count: {{ $('Edit Fields').first().json.action_words }}\n- Victim Language: {{ $('Edit Fields').first().json.victim_language }}\n- Revenue Score: {{ $('Edit Fields').first().json.revenue_score }}\n- Intent Score: {{ $('Edit Fields').first().json.intent_score }}\n- Clarity Score: {{ $('Edit Fields').first().json.clarity_score }}\n- Goal Quality Score: {{ $('Edit Fields').first().json.goal_quality_score }}\n- Notes from previous AI: {{ $('Edit Fields').first().json.coach_notes }}\n\n---\n\n## HOW TO DECIDE\n\nA lead is Hot when urgency, ownership, and intent appear together.  \nHigh pain or visible urgency must exist.  \nIntent Score should be 4 or 5 and commitment language must be present.  \nThey should sound solution focused and decisive.\n\nA lead is Warm when the problem is real but urgency is weak.  \nThey sound interested but not emotionally compelled.  \nIntent Score is typically 3 to 4 with no urgency.\n\nA lead is Cold when urgency is missing and emotional involvement is low.  \nThey show little commitment or action.  \nIntent Score is usually 1 or 2 or the tone sounds passive.\n\nA lead is Unqualified when coaching is not a fit.  \nRevenue Score of 1 with no clarity indicates Unqualified.  \nIf the problem is random, irrelevant, or spam like, mark Unqualified.\n\n---\n\n## EXAMPLES\n\nHot example:  \n\"I need this solved now and I am ready to act.\"\n\nWarm example:  \n\"I know I have this issue and I am exploring options.\"\n\nCold example:  \n\"I am just checking.\"\n\nUnqualified example:  \n\"Test message\" or meaningless submission.\n\n---\n\n## OUTPUT FORMAT (STRICT)\n\nReturn exactly:\n\nName: {{ $('Edit Fields').first().json.Name }}  \nEmail: {{ $('Edit Fields').first().json.Email }}  \nLead Stage: Hot or Warm or Cold or Unqualified  \nReason: Two or three short lines explaining emotional and logical decision  \nCoach Notes: One action step for the coach\n\n---\n\n## RULES\n\n- Do not repeat the input  \n- No extra commentary  \n- Always return one stage  \n- Be decisive  \n\n"
            }
          ]
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.googleGemini",
      "typeVersion": 1,
      "position": [
        -3472,
        -144
      ],
      "id": "e160583e-309c-4b31-a66a-58d40dd228d3",
      "name": "Message a model8",
      "credentials": {
        "googlePalmApi": {
          "id": "Gq3qNdXZmlzVb7Jg",
          "name": "Google Gemini(PaLM) Api account"
        }
      }
    },
    {
      "parameters": {
        "sendTo": "vamsikrishna2536@gmail.com",
        "subject": "New",
        "message": "Hai",
        "options": {}
      },
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        -2048,
        144
      ],
      "id": "ab1bbe85-bfcf-43bc-80a1-03f92d02d201",
      "name": "Warm Lead",
      "webhookId": "b4e5260d-8e91-44c0-9c4e-3caf8e6766de",
      "credentials": {
        "gmailOAuth2": {
          "id": "OEcIZm1duf4dQunn",
          "name": "Gmail account 2"
        }
      }
    },
    {
      "parameters": {
        "sendTo": "vamsikrishna2536@gmail.com",
        "subject": "Hi",
        "message": "New",
        "options": {}
      },
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        -2048,
        336
      ],
      "id": "87c4d471-060a-4e06-80c7-41f7dbb6f817",
      "name": "Cold Lead",
      "webhookId": "38a734f6-773f-4fd0-a4d0-b12eb94e28f8",
      "credentials": {
        "gmailOAuth2": {
          "id": "OEcIZm1duf4dQunn",
          "name": "Gmail account 2"
        }
      }
    },
    {
      "parameters": {
        "sendTo": "vamsikrishna2536@gmail.com",
        "subject": "Hi",
        "message": "New",
        "options": {}
      },
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        -2048,
        544
      ],
      "id": "cae72e3a-2d8d-4810-a3d5-1f8e37c22c2d",
      "name": "Unqualified Lead",
      "webhookId": "38a734f6-773f-4fd0-a4d0-b12eb94e28f8",
      "credentials": {
        "gmailOAuth2": {
          "id": "OEcIZm1duf4dQunn",
          "name": "Gmail account 2"
        }
      }
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "typeVersion": 1,
      "position": [
        1440,
        832
      ],
      "id": "36511c64-cef0-430a-8a9c-b4e0185597ed",
      "name": "Google Gemini Chat Model4",
      "credentials": {
        "googlePalmApi": {
          "id": "Gq3qNdXZmlzVb7Jg",
          "name": "Google Gemini(PaLM) Api account"
        }
      }
    },
    {
      "parameters": {
        "rule": {
          "interval": [
            {}
          ]
        }
      },
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.2,
      "position": [
        -1296,
        944
      ],
      "id": "771d0290-8886-4968-a02b-bd7c8770e569",
      "name": "Checks every 30min"
    },
    {
      "parameters": {
        "operation": "getAll",
        "calendar": {
          "__rl": true,
          "value": "vamsivk1465@gmail.com",
          "mode": "list",
          "cachedResultName": "vamsivk1465@gmail.com"
        },
        "returnAll": true,
        "timeMin": "={{ $now.toFormat(\"yyyy-MM-dd\") }}",
        "timeMax": "={{ $now.plus({ days: 3 }).toFormat(\"yyyy-MM-dd\") }}",
        "options": {}
      },
      "type": "n8n-nodes-base.googleCalendar",
      "typeVersion": 1.3,
      "position": [
        -1056,
        800
      ],
      "id": "66807984-8524-4ee2-a16e-322d1941e987",
      "name": "Get All Meetings",
      "credentials": {
        "googleCalendarOAuth2Api": {
          "id": "g4VAMKMrPf3B63WZ",
          "name": "Google Calendar account"
        }
      }
    },
    {
      "parameters": {
        "fieldToSplitOut": "id,summary, start.dateTime, end.dateTime, attendees[0].email, attendees[1].email, description",
        "options": {}
      },
      "type": "n8n-nodes-base.splitOut",
      "typeVersion": 1,
      "position": [
        -864,
        800
      ],
      "id": "dc10ea00-5f4d-4e55-a690-3d727baa2373",
      "name": "Split out all Meetings"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "fb70f2da-d1f5-494e-9d94-b96ef7706aae",
              "name": "start.dateTime",
              "value": "={{ $json['start.dateTime'] }}",
              "type": "string"
            },
            {
              "id": "d6f678c9-3aef-4885-9387-c0997adc2e76",
              "name": "$now",
              "value": "={{ $now }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -656,
        800
      ],
      "id": "54a30523-2757-4743-9775-6b84713d022f",
      "name": "Edit start and end time"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        -384,
        800
      ],
      "id": "0626bff2-66c7-4a57-99be-688a7aab0ba1",
      "name": "Loop "
    },
    {
      "parameters": {
        "jsCode": "const outputItems = [];\n\nfor (const item of items) {\n    if (!item.json.start || !item.json.start.dateTime) continue;\n\n    // Convert startTime from ISO string\n    const startTime = new Date(item.json.start.dateTime);\n\n    // Convert current time from $now if available, otherwise use system time\n    const now = item.json.$now ? new Date(item.json.$now) : new Date();\n\n    // Calculate difference in hours\n    const diffHours = Math.round((startTime - now) / (1000 * 60 * 60));\n\n    outputItems.push({\n        json: {\n            eventId: item.json.id || null,\n            summary: item.json.summary || null,\n            hoursUntilStart: diffHours <= 0 ? \"0hr\" : (diffHours === 1 ? \"1hr\" : `${diffHours}hrs`)\n        }\n    });\n}\n\nreturn outputItems;\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -64,
        816
      ],
      "id": "817db724-8e70-436b-881c-a45a282110c1",
      "name": "Checks the time diff ",
      "alwaysOutputData": true
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "d10833b8-63d8-4353-93e4-37a8c32c4e67",
              "name": "time",
              "value": "={{ $json.hoursUntilStart }}",
              "type": "string"
            },
            {
              "id": "2f669074-3ed7-4c3e-9c42-e7c02545db7f",
              "name": "summary",
              "value": "={{ $('Split out all Meetings').item.json.summary }}",
              "type": "string"
            },
            {
              "id": "e6a3ea7a-85b6-4e92-9168-6087f3587eea",
              "name": "['attendees[1].email']",
              "value": "={{ $('Get All Meetings').item.json.attendees[0].email }}",
              "type": "string"
            },
            {
              "id": "a1f961b0-69ea-4507-8fec-dd831ee9dad3",
              "name": "start.dateTime",
              "value": "={{ new Date($('Split out all Meetings').item.json['start.dateTime']).toLocaleString('en-IN', { timeZone: 'Asia/Kolkata' }) }}",
              "type": "string"
            },
            {
              "id": "f8c6c483-49df-4d8a-8d7d-90da2a6ba5cd",
              "name": "creator.email",
              "value": "={{ $('Get All Meetings').item.json.creator.email }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        160,
        816
      ],
      "id": "4a59ef91-2908-47b9-8dbe-57c9c68ccebc",
      "name": "Edit required fields in calender"
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.time }}",
                    "rightValue": "2hr",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "6099b2d2-dab8-4f46-9def-2d5212842ca3"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "2hr"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "1862f489-fcc6-4dbc-aaa4-ac70af544a75",
                    "leftValue": "={{ $json.time }}",
                    "rightValue": "6hr",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "6hr"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "3cf1231d-d375-441c-95e5-ce09230cdc99",
                    "leftValue": "={{ $json.time }}",
                    "rightValue": "1hr",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "1hr"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "e22774b6-296f-4200-b071-20265266bf0a",
                    "leftValue": "={{ $json.isValid.toString() }}",
                    "rightValue": "false",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        800,
        784
      ],
      "id": "d33717ce-4119-487e-ab6a-1d7e803abb30",
      "name": "Switch btw hrs",
      "alwaysOutputData": false
    },
    {
      "parameters": {
        "modelId": {
          "__rl": true,
          "value": "models/gemini-2.5-flash-lite-preview-06-17",
          "mode": "list",
          "cachedResultName": "models/gemini-2.5-flash-lite-preview-06-17"
        },
        "messages": {
          "values": [
            {
              "content": "={{ $('Edit required fields in calender').item.json.time }}, {{ $('Edit required fields in calender').item.json.summary }},{{ $('Edit required fields in calender').item.json['attendees[1].email'] }},{{ $('Edit required fields in calender').item.json.start.dateTime }}, {{ $('Edit required fields in calender').item.json.creator.email }}"
            }
          ]
        },
        "simplify": false,
        "jsonOutput": true,
        "options": {
          "systemMessage": "=You are an AI assistant for professional scheduling and reminders.  \nYour task is to write concise, friendly, and exciting emails for booked meetings.  \n\nInputs:  \n- Attendee email: {{ $('Edit required fields in calender').item.json['attendees[1].email'] }}\n- Attendee name: (infer from email if possible, e.g., \"john.doe@gmail.com\" â†’ \"John\")  \n- Meeting summary: {{ $('Edit required fields in calender').item.json.summary }}\n- Meeting date and time: {{ $('Edit required fields in calender').item.json.start.dateTime }}\n- Time until meeting:{{ $('Edit required fields in calender').item.json.time }}(e.g., \"2hrs\", \"3hrs\")  \n- Type of email: (confirmation or reminder)  \n- Organizer email: {{ $('Edit required fields in calender').item.json.creator.email }} (use this to refer to the organizerâ€™s name professionally)\n\nRequirements:  \n1. If `emailType` is \"confirmation\", write a professional email acknowledging the booking. Include a friendly greeting, thank the attendee, mention the meeting date/time, and add an exciting note about looking forward to the discussion using the `hoursUntilStart` input.  \n2. If `emailType` is \"reminder\", write a friendly reminder 2 hours before the meeting. Include the meeting summary, date/time, and an enthusiastic note about speaking soon using `hoursUntilStart`.  \n3. Emails should be:  \n   - 3â€“5 sentences  \n   - Polite, professional, and exciting  \n   - Include a greeting using the attendeeâ€™s name  \n   - Include a professional sign-off using the organizerâ€™s name  \n   - Use phrases like â€œIâ€™m really looking forward to our conversation,â€ â€œcanâ€™t wait to discuss,â€ or â€œexcited to connect.â€  \n4. Output only the ready-to-send email text. No explanations.\n\nExample output (confirmation):  \n\"Dear John,  \nThank you for scheduling a meeting regarding 'Project Discussion'. Your meeting is confirmed for October 16th at 12:00 PM IST. Iâ€™m really looking forward to our conversation and canâ€™t wait to dive into the discussion with you in just 2hrs!  \nBest regards,  \nJane Doe\"\n\nExample output (reminder):  \n\"Dear John,  \nThis is a friendly reminder of your upcoming meeting 'Project Discussion' scheduled for October 16th at 12:00 PM IST. Iâ€™m excited to connect with you in 2hrs and discuss everything in detail. Please let me know if you need to adjust the timing.  \nBest regards,  \nJane Doe\"\n"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.googleGemini",
      "typeVersion": 1,
      "position": [
        1120,
        672
      ],
      "id": "94d314a2-b92b-4baf-8898-ff3c28ba62b0",
      "name": "Send personalized message ( Email )",
      "credentials": {
        "googlePalmApi": {
          "id": "Gq3qNdXZmlzVb7Jg",
          "name": "Google Gemini(PaLM) Api account"
        }
      }
    },
    {
      "parameters": {
        "text": "={{ $json.candidates[0].content.parts[0].text }}",
        "attributes": {
          "attributes": [
            {
              "name": "Subject",
              "description": "Take subject out with clear idea",
              "required": true
            },
            {
              "name": "Body",
              "description": "Take out body with clear words",
              "required": true
            }
          ]
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.informationExtractor",
      "typeVersion": 1.2,
      "position": [
        1504,
        672
      ],
      "id": "fdc602ae-c42f-41ed-91ab-7ea255e3efeb",
      "name": "Extract Information out"
    },
    {
      "parameters": {
        "sendTo": "=vamsikrishna2536@gmail.com",
        "subject": "={{ $json.output.Subject }}",
        "emailType": "text",
        "message": "={{ $json.output.Body }}",
        "options": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        1840,
        672
      ],
      "id": "dc0053bd-9583-4096-a3fe-59aa4ab93d75",
      "name": "Send a Booking email alert",
      "webhookId": "8bc0d4d6-8c1c-4bea-9f46-d46cb034971a",
      "credentials": {
        "gmailOAuth2": {
          "id": "UbWO1LFfZ6s8MzMA",
          "name": "Gmail account"
        }
      }
    },
    {
      "parameters": {
        "modelId": {
          "__rl": true,
          "value": "models/gemini-2.5-flash-lite-preview-06-17",
          "mode": "list",
          "cachedResultName": "models/gemini-2.5-flash-lite-preview-06-17"
        },
        "messages": {
          "values": [
            {
              "content": "=You are an assistant for sending professional and friendly reminders or confirmations via WhatsApp or Telegram.  \nYour task is to write concise, engaging, and exciting messages for booked meetings.  \n\nInputs:  \n- Attendee email: {{ $('Edit required fields in calender').item.json['attendees[1].email'] }}\n- Attendee name: (infer from email if possible, e.g., \"john.doe@gmail.com\" â†’ \"John\")  \n- Meeting summary: {{ $('Edit required fields in calender').item.json.summary }}\n- Meeting date and time: {{ $('Edit required fields in calender').item.json.start.dateTime }}\n- Time until meeting: {{ $('Edit required fields in calender').item.json.time }} (e.g., \"2hrs\", \"3hrs\")  \n- Type of message: (confirmation or reminder)  \n- Organizer email: {{ $('Edit required fields in calender').item.json.creator.email }} (use this to refer to the organizerâ€™s name professionally)\n\nRequirements:  \n1. If `messageType` is \"confirmation\", write a short WhatsApp/Telegram message acknowledging the booking. Include:  \n   - Friendly greeting using the attendeeâ€™s name  \n   - Meeting summary and date/time  \n   - Exciting note using `time` (e.g., \"Looking forward to connecting with you in 2hrs!\")  \n   - Optional quick call-to-action if needed  \n2. If `messageType` is \"reminder\", write a concise reminder message 2 hours before the meeting. Include:  \n   - Meeting summary and date/time  \n   - Exciting, friendly note mentioning `time`  \n   - Optional note to reply if they need to reschedule  \n3. Messages should be:  \n   - Short and natural (1â€“3 sentences)  \n   - Friendly, professional, and enthusiastic  \n   - Easy to read on mobile chat  \n4. Output only the ready-to-send message text, no extra explanations.\n\nExample output (confirmation):  \n\"Hi John, thanks for scheduling a meeting about 'Project Discussion'. It's set for Oct 16th at 12:00 PM IST. Really excited to connect with you in just 2hrs!\"  \n\nExample output (reminder):  \n\"Hi John, a quick reminder about your 'Project Discussion' meeting at Oct 16th, 12:00 PM IST. Can't wait to talk with you in 2hrs!\"\n"
            }
          ]
        },
        "simplify": false,
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.googleGemini",
      "typeVersion": 1,
      "position": [
        1216,
        976
      ],
      "id": "e3d45348-c4fd-467e-9db4-4fda09da4f9b",
      "name": "Send personalized DM",
      "credentials": {
        "googlePalmApi": {
          "id": "Gq3qNdXZmlzVb7Jg",
          "name": "Google Gemini(PaLM) Api account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "23",
        "text": "HI",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        1744,
        928
      ],
      "id": "8ee5e904-9c16-4112-9a94-a100d6eb0724",
      "name": "Send a remainder in Telegram",
      "webhookId": "0b182a8a-c988-4111-a16f-68a83bde7f1f",
      "credentials": {
        "telegramApi": {
          "id": "gwHBxrkrPXY0I5Fk",
          "name": "Normal"
        }
      }
    },
    {
      "parameters": {
        "operation": "send",
        "phoneNumberId": "802657959596026",
        "recipientPhoneNumber": "+918919053970",
        "textBody": "Hello",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.whatsApp",
      "typeVersion": 1,
      "position": [
        1728,
        1136
      ],
      "id": "9843a43a-081d-4de9-b9ac-5db47f8324a9",
      "name": "Send a remainder in Whatsapp",
      "webhookId": "ee19619e-9f28-459b-a7dc-5ab34fa53e53",
      "credentials": {
        "whatsAppApi": {
          "id": "ixk5U1dBT3xISilr",
          "name": "WhatsApp account"
        }
      }
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "6924e89c-a091-4dce-adee-db0a6fdd4bcc",
              "name": "['attendees[1].email']",
              "value": "={{ $('Edit required fields in calender').item.json['attendees[1].email'] }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -960,
        1328
      ],
      "id": "4b324289-90be-4df2-9eab-e23d7835f6e9",
      "name": "Edit only Req Fields"
    },
    {
      "parameters": {
        "jsCode": "// Get time value from previous node\nconst time = $json.time?.toLowerCase()?.trim() || \"\";\n\n// Allowed time values\nconst validTimes = [\"1hr\", \"2hrs\", \"6hrs\"];\n\n// Check if matches\nconst isValid = validTimes.includes(time);\n\n// Return result\nreturn [{ time, isValid }];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        368,
        816
      ],
      "id": "88bdb333-99e5-414e-82ad-1725ae4dc62d",
      "name": "Check true or false "
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1IUNIvKOc2s6qmjwrMZLpuhgvvK_py2sXskapsOswS04",
          "mode": "list",
          "cachedResultName": "Coaches",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1IUNIvKOc2s6qmjwrMZLpuhgvvK_py2sXskapsOswS04/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "Websiteforms",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1IUNIvKOc2s6qmjwrMZLpuhgvvK_py2sXskapsOswS04/edit#gid=0"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "Email",
              "lookupValue": "={{ $json['attendees[1].email'] }}"
            }
          ]
        },
        "combineFilters": "OR",
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        -688,
        1328
      ],
      "id": "acd4fb6b-f406-449b-8acf-ab50fccc405a",
      "name": "Get row(s) in sheet4",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "3MsYFPOz6gYs3lBk",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "modelId": {
          "__rl": true,
          "value": "gpt-4.1-mini-2025-04-14",
          "mode": "list",
          "cachedResultName": "GPT-4.1-MINI-2025-04-14"
        },
        "messages": {
          "values": [
            {
              "content": "=You are an AI assistant that prepares a detailed Pre-Call Brief for a coach.\n\nYou will receive structured data from an automation system that includes all relevant fields about a lead, such as:\n\n- Date: {{ $json.Date }}\n- Name: {{ $json.Name }}\n- Email: {{ $json.Email }}\n- Text: {{ $json.Text }}\n- problem_summary: {{ $json.problem_summary }}\n- need_type: {{ $json.need_type }}\n- lead_score: {{ $json.lead_score }}\n- Lead Stage: {{ $json[\"Lead Stage\"] }}\n- reason: {{ $json.reason }}\n- coach_notes: {{ $json.coach_notes }}\n(and possibly other fields in the same format)\n\n---\n\n### ðŸ§­ Instructions\n\n1. Use **all fields available** â€” do not ignore any.\n2. Identify the type of lead:\n   - If itâ€™s system-generated, spam, or irrelevant â†’ mention clearly.\n   - If itâ€™s a real human lead â†’ summarize their goals, needs, and challenges.\n3. Extract insights:\n   - â€œTextâ€ â†’ what the person said.\n   - â€œproblem_summaryâ€ â†’ what issue or goal they have.\n   - â€œneed_typeâ€ â†’ what category this falls into.\n   - â€œlead_scoreâ€ & â€œLead Stageâ€ â†’ how ready or qualified they are.\n   - â€œreasonâ€ & â€œcoach_notesâ€ â†’ why it was classified that way and what to do next.\n\n---\n\n### ðŸ§¾ Output Format\n\n**1. Lead Snapshot**\n- Name:\n- Email:\n- Date:\n- Lead Stage:\n- Lead Score:\n- Need Type:\n\n**2. Conversation Summary**\nSummarize the â€œTextâ€ field in one or two lines and explain what it tells us about the leadâ€™s intent.\n\n**3. Problem / Goal**\nExplain what problem or goal they have using â€œproblem_summaryâ€.\n\n**4. Context & Insights**\nSummarize the â€œreasonâ€ and â€œcoach_notesâ€ fields to help the coach understand how to approach this lead.\n\n**5. Preparation for Coach**\n- What the coach should know before the call.\n- Recommended tone or communication style.\n- What to prepare (stories, tools, examples).\n\n**6. Smart Questions to Ask**\nWrite 4â€“6 personalized questions that help the coach explore the leadâ€™s goals, pain points, and readiness (skip if irrelevant).\n\n**7. Recommended Next Step**\nClearly state what action to take:\n- Book a call / proceed\n- Follow up\n- Ignore / mark as system message\n- Gather more information\n\n---\n\n### Output\nProvide a detailed, structured **Pre-Call Brief** in clear, human-readable language following the above format."
            }
          ]
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 1.8,
      "position": [
        -384,
        1328
      ],
      "id": "44224d1d-1822-4e51-9abf-5668ce402e53",
      "name": "Message a model",
      "credentials": {
        "openAiApi": {
          "id": "8cTwctTGeEBOJeUq",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "oAuth2",
        "select": "channel",
        "channelId": {
          "__rl": true,
          "value": "C09PV3DSRJQ",
          "mode": "list",
          "cachedResultName": "n8n"
        },
        "text": "=Pre call brief:\n{{ $json.Name }}\n{{ $json.Email }}\n{{ $json.Lead_Stage }}\n{{ $json.Need_Type }}\n\n",
        "otherOptions": {}
      },
      "type": "n8n-nodes-base.slack",
      "typeVersion": 2.3,
      "position": [
        480,
        1328
      ],
      "id": "9ee02d20-83a7-4f73-9069-01599429bbc1",
      "name": "Send a message4",
      "webhookId": "24db3fa1-87d7-415d-81d0-5cab88ec98d6",
      "credentials": {
        "slackOAuth2Api": {
          "id": "Rb7HyhAgq0iIU3TT",
          "name": "Slack account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// Split the Lead Snapshot into structured fields\n\nfor (const item of $input.all()) {\n  const snapshot = item.json.Lead_Snapshot || \"\";\n\n  // Extract key fields using regex\n  const name = snapshot.match(/Name:\\s*(.*?)(?=\\s*- Email|$)/i)?.[1]?.trim() || \"\";\n  const email = snapshot.match(/Email:\\s*(.*?)(?=\\s*- Date|$)/i)?.[1]?.trim() || \"\";\n  const date = snapshot.match(/Date:\\s*(.*?)(?=\\s*- Lead Stage|$)/i)?.[1]?.trim() || \"\";\n  const leadStage = snapshot.match(/Lead Stage:\\s*(.*?)(?=\\s*- Lead Score|$)/i)?.[1]?.trim() || \"\";\n  const leadScore = snapshot.match(/Lead Score:\\s*(.*?)(?=\\s*- Need Type|$)/i)?.[1]?.trim() || \"\";\n  const needType = snapshot.match(/Need Type:\\s*(.*)/i)?.[1]?.trim() || \"\";\n\n  // Add structured fields to JSON\n  item.json = {\n    ...item.json,\n    Name: name,\n    Email: email,\n    Date: date,\n    Lead_Stage: leadStage,\n    Lead_Score: leadScore,\n    Need_Type: needType\n  };\n}\n\nreturn $input.all();\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        256,
        1328
      ],
      "id": "01156c50-405b-4bf7-a751-5b8e6b4f16a0",
      "name": "Divide Lead Details"
    },
    {
      "parameters": {
        "content": "# Meeting Remainder for \n## 1. 24hrs\n## 2. 6hrs\n## 3. 1hr precall + remainder",
        "height": 1440,
        "width": 3728
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -1424,
        512
      ],
      "typeVersion": 1,
      "id": "787bad7b-29f5-4825-8005-67d0d561c833",
      "name": "Sticky Note"
    },
    {
      "parameters": {
        "jsCode": "// n8n Code Node: Split Pre-Call Brief Markdown into JSON sections (with Summary fix)\n\nfor (const item of $input.all()) {\n  const content = item.json.message?.content || item.json.content || \"\";\n\n  // Helper function to extract section content safely\n  function extractSection(title) {\n    const regex = new RegExp(`\\\\*\\\\*${title}\\\\*\\\\*[\\\\s\\\\S]*?(?=\\\\n\\\\n---|$)`, \"i\");\n    const match = content.match(regex);\n    if (!match) return \"not available\";\n\n    return match[0]\n      .replace(new RegExp(`\\\\*\\\\*${title}\\\\*\\\\*`, \"i\"), \"\")\n      .replace(/^-+|\\*+|\\n+/g, \"\")\n      .trim();\n  }\n\n  // Extract each section\n  const Lead_Snapshot = extractSection(\"1\\\\. Lead Snapshot\");\n  const Conversation_Summary = extractSection(\"2\\\\. Conversation Summary\");\n  const Problem_Goal = extractSection(\"3\\\\. Problem / Goal\");\n  const Context_Insights = extractSection(\"4\\\\. Context & Insights\");\n  const Preparation_for_Coach = extractSection(\"5\\\\. Preparation for Coach\");\n  const Smart_Questions = extractSection(\"6\\\\. Smart Questions to Ask\");\n  const Recommended_Next_Step = extractSection(\"7\\\\. Recommended Next Step\");\n\n  // FIX: Capture the Summary section at the end (even if not separated by ---)\n  let Summary = \"not available\";\n  const summaryMatch = content.match(/\\*\\*Summary:\\*\\*[\\s\\S]*$/i);\n  if (summaryMatch) {\n    Summary = summaryMatch[0]\n      .replace(/\\*\\*Summary:\\*\\*/i, \"\")\n      .trim();\n  }\n\n  // Structured JSON output\n  item.json = {\n    Lead_Snapshot,\n    Conversation_Summary,\n    Problem_Goal,\n    Context_Insights,\n    Preparation_for_Coach,\n    Smart_Questions,\n    Recommended_Next_Step,\n    Summary\n  };\n}\n\nreturn $input.all();\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        0,
        1328
      ],
      "id": "c07f33ff-71f6-406c-aa8d-ceee3eaacf3f",
      "name": "Code in JavaScript2"
    },
    {
      "parameters": {
        "operation": "appendOrUpdate",
        "documentId": {
          "__rl": true,
          "value": "1IUNIvKOc2s6qmjwrMZLpuhgvvK_py2sXskapsOswS04",
          "mode": "list",
          "cachedResultName": "Lead Qualification System",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1IUNIvKOc2s6qmjwrMZLpuhgvvK_py2sXskapsOswS04/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 560820225,
          "mode": "list",
          "cachedResultName": "Master Leads",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1IUNIvKOc2s6qmjwrMZLpuhgvvK_py2sXskapsOswS04/edit#gid=560820225"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Name": "={{ $json.name }}",
            "Email": "={{ $json.email }}",
            "Lead Status": "={{ $json.lead_stage }}",
            "Sender ID": "Website",
            "Phonenumber": "={{ $('Edit Req Fields for Form').first().json['Whatsapp number'] }}",
            "Core Pain": "={{ $('Code in JavaScript').first().json.core_pain }}",
            "Core Reason": "={{ $json.reason }}"
          },
          "matchingColumns": [
            "Email"
          ],
          "schema": [
            {
              "id": "Name",
              "displayName": "Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Email",
              "displayName": "Email",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Sender ID",
              "displayName": "Sender ID",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Phonenumber",
              "displayName": "Phonenumber",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Core Pain",
              "displayName": "Core Pain",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Core Reason",
              "displayName": "Core Reason",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Lead Status",
              "displayName": "Lead Status",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        -2560,
        -304
      ],
      "id": "fd18dc23-890d-4ce9-a0a4-db8a55f74698",
      "name": "Master Leads Sheet",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "3MsYFPOz6gYs3lBk",
          "name": "Google Sheets account"
        }
      }
    }
  ],
  "connections": {
    "Website Signup or Webinar Signup": {
      "main": [
        [
          {
            "node": "Edit Req Fields for Form",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If duplicates Found vs Not Found": {
      "main": [
        [
          {
            "node": "Message a model8",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Update Form Sheet 1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Check duplicates": {
      "main": [
        [
          {
            "node": "If duplicates Found vs Not Found",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Req Fields for Form": {
      "main": [
        [
          {
            "node": "Message a model4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript": {
      "main": [
        [
          {
            "node": "Edit Fields",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields": {
      "main": [
        [
          {
            "node": "Check duplicates",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript1": {
      "main": [
        [
          {
            "node": "Edit Fields1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields1": {
      "main": [
        [
          {
            "node": "Switch",
            "type": "main",
            "index": 0
          },
          {
            "node": "Master Leads Sheet",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch": {
      "main": [
        [
          {
            "node": "Hot Slack Message",
            "type": "main",
            "index": 0
          },
          {
            "node": "Hot Lead",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Warm Lead",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Cold Lead",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Unqualified Lead",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Hot Lead": {
      "main": [
        [
          {
            "node": "Append row in sheet",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Message a model4": {
      "main": [
        [
          {
            "node": "Code in JavaScript",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Message a model8": {
      "main": [
        [
          {
            "node": "Code in JavaScript1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Gemini Chat Model4": {
      "ai_languageModel": [
        [
          {
            "node": "Extract Information out",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Checks every 30min": {
      "main": [
        [
          {
            "node": "Get All Meetings",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get All Meetings": {
      "main": [
        [
          {
            "node": "Split out all Meetings",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Split out all Meetings": {
      "main": [
        [
          {
            "node": "Edit start and end time",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit start and end time": {
      "main": [
        [
          {
            "node": "Loop ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop ": {
      "main": [
        [],
        [
          {
            "node": "Checks the time diff ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Checks the time diff ": {
      "main": [
        [
          {
            "node": "Edit required fields in calender",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit required fields in calender": {
      "main": [
        [
          {
            "node": "Check true or false ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch btw hrs": {
      "main": [
        [
          {
            "node": "Send personalized message ( Email )",
            "type": "main",
            "index": 0
          },
          {
            "node": "Send personalized DM",
            "type": "main",
            "index": 0
          },
          {
            "node": "Loop ",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Send personalized message ( Email )",
            "type": "main",
            "index": 0
          },
          {
            "node": "Send personalized DM",
            "type": "main",
            "index": 0
          },
          {
            "node": "Loop ",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Loop ",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Edit only Req Fields",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Send personalized message ( Email )": {
      "main": [
        [
          {
            "node": "Extract Information out",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extract Information out": {
      "main": [
        [
          {
            "node": "Send a Booking email alert",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Send personalized DM": {
      "main": [
        [
          {
            "node": "Send a remainder in Telegram",
            "type": "main",
            "index": 0
          },
          {
            "node": "Send a remainder in Whatsapp",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit only Req Fields": {
      "main": [
        [
          {
            "node": "Get row(s) in sheet4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Check true or false ": {
      "main": [
        [
          {
            "node": "Switch btw hrs",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Message a model": {
      "main": [
        [
          {
            "node": "Code in JavaScript2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Divide Lead Details": {
      "main": [
        [
          {
            "node": "Send a message4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript2": {
      "main": [
        [
          {
            "node": "Divide Lead Details",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s) in sheet4": {
      "main": [
        [
          {
            "node": "Message a model",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "settings": {
    "executionOrder": "v1"
  },
  "staticData": null,
  "meta": {
    "templateCredsSetupCompleted": true
  },
  "pinData": {
    "Website Signup or Webinar Signup": [
      {
        "json": {
          "Name": "Vamsi",
          "Email": "vamsikrishna2536@gmail.com",
          "Whatsapp number": 91987654321,
          "Business type": "Agency",
          "Monthly revenue range": "2k",
          "What's your biggest challenge right now?": "Not getting enough leads",
          "How soon do you want to solve this": "Immediate",
          "What is your biggest goal in the next 90 days": "I want to close 3 deals and earn good revenue",
          "submittedAt": "2025-11-16T08:32:46.764+01:00",
          "formMode": "test"
        }
      }
    ],
    "If duplicates Found vs Not Found": [
      {
        "json": {}
      }
    ],
    "Check duplicates": [
      {
        "json": {}
      }
    ],
    "Edit Req Fields for Form": [
      {
        "json": {
          "Name": "Vamsi",
          "Email": "vamsikrishna2536@gmail.com",
          "Whatsapp number": 91987654321,
          "Business type": "Agency",
          "Monthly revenue range": "2k",
          "What's your biggest challenge right now?": "Not getting enough leads",
          "How soon do you want to solve this": "Immediate",
          "What is your biggest goal in the next 90 days": "I want to close 3 deals and earn good revenue"
        }
      }
    ],
    "Code in JavaScript": [
      {
        "json": {
          "core_pain": "Not getting enough leads",
          "need_type": "sales",
          "emotion": "hopeful",
          "pain_intensity": 4,
          "committed_words": 1,
          "urgency_flag": true,
          "action_words": 0,
          "victim_language": false,
          "revenue_score": 2,
          "intent_score": 4,
          "clarity_score": 3,
          "goal_quality_score": 4,
          "coach_notes": "Schedule strategy call"
        }
      }
    ],
    "Edit Fields": [
      {
        "json": {
          "core_pain": "Not getting enough leads",
          "need_type": "sales",
          "emotion": "hopeful",
          "pain_intensity": 4,
          "committed_words": 1,
          "urgency_flag": true,
          "action_words": 0,
          "victim_language": false,
          "revenue_score": 2,
          "intent_score": 4,
          "clarity_score": 3,
          "goal_quality_score": 4,
          "coach_notes": "Schedule strategy call",
          "Name": "Vamsi",
          "Email": "vamsikrishna2536@gmail.com"
        }
      }
    ],
    "Code in JavaScript1": [
      {
        "json": {
          "name": "Vamsi",
          "email": "vamsikrishna2536@gmail.com",
          "lead_stage": "Hot",
          "reason": "Urgency flag is true and intent score is high, indicating a strong desire for a solution.",
          "coach_notes": "Schedule strategy call."
        }
      }
    ],
    "Edit Fields1": [
      {
        "json": {
          "name": "Vamsi",
          "email": "vamsikrishna2536@gmail.com",
          "lead_stage": "Hot",
          "reason": "Vamsi shows strong urgency with a clear problem and readiness to invest. Despite moderate pain intensity, the intent and ownership are high, with no victim language and a hopeful tone. These factors confirm a strong desire to change now.",
          "coach_notes": "Prioritize immediate engagement and offer tailored marketing strategies to convert quickly."
        }
      }
    ],
    "Message a model4": [
      {
        "json": {
          "content": {
            "parts": [
              {
                "text": "{\n  \"CorePain\": \"Not getting enough leads\",\n  \"NeedType\": \"sales\",\n  \"Emotion\": \"hopeful\",\n  \"PainIntensity\": 4,\n  \"CommittedWordsCount\": 1,\n  \"UrgencyFlag\": true,\n  \"ActionWordsCount\": 0,\n  \"VictimLanguage\": false,\n  \"RevenueScore\": 2,\n  \"IntentScore\": 4,\n  \"ClarityScore\": 3,\n  \"GoalQualityScore\": 4,\n  \"Notes\": \"Schedule strategy call\"\n}"
              }
            ],
            "role": "model"
          },
          "finishReason": "STOP",
          "index": 0
        }
      }
    ],
    "Checks the time diff ": [
      {
        "json": {
          "eventId": null,
          "summary": null,
          "hoursUntilStart": "18hrs"
        }
      }
    ],
    "Edit required fields in calender": [
      {
        "json": {
          "time": "18hrs",
          "summary": "30 Min Meeting between Lumoscale and v vamsi",
          "attendees[1].email": "vamsivk1465@gmail.com",
          "start": {
            "dateTime": "1/11/2025, 8:00:00 pm"
          },
          "creator": {
            "email": "vamsivk1465@gmail.com"
          }
        }
      }
    ],
    "Edit only Req Fields": [
      {
        "json": {
          "attendees[1].email": "vamsivk1465@gmail.com"
        }
      }
    ],
    "Check true or false ": [
      {
        "json": {
          "time": "18hrs",
          "isValid": false
        }
      }
    ],
    "Message a model": [
      {
        "json": {
          "index": 0,
          "message": {
            "role": "assistant",
            "content": "**Pre-Call Brief**\n\n---\n\n**1. Lead Snapshot**  \n- Name: Vadla Vamsi Krishna  \n- Email: vamsivk1465@gmail.com  \n- Date: 2025-10-31T17:06:31.821+01:00  \n- Lead Stage: Hot  \n- Lead Score: 1  \n- Need Type: System / Irrelevant  \n\n---\n\n**2. Conversation Summary**  \nThe message is an automated notification alerting Vadla Vamsi Krishna about a login to their account from a new device. It asks if the login was performed by them. There is no indication of personal intent or coaching-related inquiry.\n\n---\n\n**3. Problem / Goal**  \nThis is a system-generated security alert regarding a login attempt and does not represent a coaching-related problem or goal.\n\n---\n\n**4. Context & Insights**  \nThe reason field clarifies that this message is an automated login alert and unrelated to coaching needs or genuine human interest. Coach notes explicitly instruct to ignore this message as it is not a potential lead for coaching engagement.\n\n---\n\n**5. Preparation for Coach**  \n- The coach does not need to prepare for engagement as this is not a genuine lead.  \n- No call or communication is necessary, and no coaching materials or stories need to be prepared.  \n- Tone or style is irrelevant in this case because no outreach is recommended.\n\n---\n\n**6. Smart Questions to Ask**  \n*Not applicable* â€” this lead is system-generated and not relevant for coaching interaction.\n\n---\n\n**7. Recommended Next Step**  \nIgnore this message. Mark as a system notification and do not proceed with any coaching outreach.\n\n---\n\n**Summary:**  \nThis lead, Vadla Vamsi Krishna, has sent an automated login alert message that is unrelated to coaching. Despite the â€œHotâ€ lead stage label, the very low lead score and contextual details denote it as an irrelevant system message. The coach should disregard and take no action.",
            "refusal": null,
            "annotations": []
          },
          "logprobs": null,
          "finish_reason": "stop"
        }
      }
    ],
    "Code in JavaScript2": [
      {
        "json": {
          "Lead_Snapshot": "- Name: Vadla Vamsi Krishna  - Email: vamsivk1465@gmail.com  - Date: 2025-10-31T17:06:31.821+01:00  - Lead Stage: Hot  - Lead Score: 1  - Need Type: System / Irrelevant",
          "Conversation_Summary": "The message is an automated notification alerting Vadla Vamsi Krishna about a login to their account from a new device. It asks if the login was performed by them. There is no indication of personal intent or coaching-related inquiry.",
          "Problem_Goal": "This is a system-generated security alert regarding a login attempt and does not represent a coaching-related problem or goal.",
          "Context_Insights": "The reason field clarifies that this message is an automated login alert and unrelated to coaching needs or genuine human interest. Coach notes explicitly instruct to ignore this message as it is not a potential lead for coaching engagement.",
          "Preparation_for_Coach": "- The coach does not need to prepare for engagement as this is not a genuine lead.  - No call or communication is necessary, and no coaching materials or stories need to be prepared.  - Tone or style is irrelevant in this case because no outreach is recommended.",
          "Smart_Questions": "Not applicable â€” this lead is system-generated and not relevant for coaching interaction.",
          "Recommended_Next_Step": "Ignore this message. Mark as a system notification and do not proceed with any coaching outreach.",
          "Summary": "This lead, Vadla Vamsi Krishna, has sent an automated login alert message that is unrelated to coaching. Despite the â€œHotâ€ lead stage label, the very low lead score and contextual details denote it as an irrelevant system message. The coach should disregard and take no action."
        }
      }
    ],
    "Divide Lead Details": [
      {
        "json": {
          "Lead_Snapshot": "- Name: Vadla Vamsi Krishna  - Email: vamsivk1465@gmail.com  - Date: 2025-10-31T17:06:31.821+01:00  - Lead Stage: Hot  - Lead Score: 1  - Need Type: System / Irrelevant",
          "Conversation_Summary": "The message is an automated notification alerting Vadla Vamsi Krishna about a login to their account from a new device. It asks if the login was performed by them. There is no indication of personal intent or coaching-related inquiry.",
          "Problem_Goal": "This is a system-generated security alert regarding a login attempt and does not represent a coaching-related problem or goal.",
          "Context_Insights": "The reason field clarifies that this message is an automated login alert and unrelated to coaching needs or genuine human interest. Coach notes explicitly instruct to ignore this message as it is not a potential lead for coaching engagement.",
          "Preparation_for_Coach": "- The coach does not need to prepare for engagement as this is not a genuine lead.  - No call or communication is necessary, and no coaching materials or stories need to be prepared.  - Tone or style is irrelevant in this case because no outreach is recommended.",
          "Smart_Questions": "Not applicable â€” this lead is system-generated and not relevant for coaching interaction.",
          "Recommended_Next_Step": "Ignore this message. Mark as a system notification and do not proceed with any coaching outreach.",
          "Summary": "This lead, Vadla Vamsi Krishna, has sent an automated login alert message that is unrelated to coaching. Despite the â€œHotâ€ lead stage label, the very low lead score and contextual details denote it as an irrelevant system message. The coach should disregard and take no action.",
          "Name": "Vadla Vamsi Krishna",
          "Email": "vamsivk1465@gmail.com",
          "Date": "2025-10-31T17:06:31.821+01:00",
          "Lead_Stage": "Hot",
          "Lead_Score": "1",
          "Need_Type": "System / Irrelevant"
        }
      }
    ]
  },
  "versionId": "58aab829-6088-4c38-9183-099949839c85",
  "triggerCount": 0,
  "shared": [
    {
      "createdAt": "2025-11-16T07:33:05.836Z",
      "updatedAt": "2025-11-16T07:33:05.836Z",
      "role": "workflow:owner",
      "workflowId": "C8Mvab5ljKseAAcA",
      "projectId": "VDyoKZWt3i5eAZSO"
    }
  ],
  "tags": []
}